<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en-us">
<link rel="stylesheet" href="http://unicode.org/reports/reports.css" type="text/css">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>UTR# 36: Unicode Security Considerations</title>
<style type="text/css">
<!--
span.special { text-decoration: underline; font-weight: bold; color: #FF0000;font-family: monospace; font-size: 12px }
.idn-head { font-size: 12px; background-color: #C0C0C0 }
span.mono    { font-family: monospace; font-size: 12px }
.idn-example {font-size:12px; font-family:Arial Unicode MS, san-serif}
span.border {background-color: white; color: red; border-left: 1px solid  blue; border-right: 1px solid blue}
-->
</style>
</head>

<body>

<table class="header" cellspacing="0" cellpadding="0" width="100%">
  <tr>
    <td class="icon"><a href="http://www.unicode.org">
    <img align="middle" alt="[Unicode]" border="0" src="http://www.unicode.org/webscripts/logo60s2.gif" width="34" height="33"></a>&nbsp;&nbsp;<a class="bar" href="http://www.unicode.org/reports">Technical 
    Reports</a></td>
  </tr>
  <tr>
    <td class="gray">&nbsp;</td>
  </tr>
</table>
<div class="body">
  <h2 align="center"><font color="#FF0000">Draft</font> Unicode Technical Report #36</h2>
  <h1>Unicode Security Considerations</h1>
  <table border="1" cellpadding="2" width="90%" style="border-collapse: collapse" cellspacing="0">
    <tr>
      <td valign="top">Revision</td>
      <td valign="top">3<font color="#FF0000"> (working draft $Revision: 1.19 $)</font></td>
    </tr>
    <tr>
      <td valign="top">Authors</td>
      <td valign="top">Mark Davis (<a href="mailto:mark.davis@us.ibm.com">mark.davis@us.ibm.com</a>)</td>
    </tr>
    <tr>
      <td valign="top">Date</td>
      <td valign="top" class="old_changed">$Date: 2005/06/03 17:56:16 $</td>
    </tr>
    <tr>
      <td valign="top">This Version</td>
      <td valign="top"><a href="http://www.unicode.org/reports/tr36/tr36-2.html">
      http://www.unicode.org/reports/tr36/tr36-2.html</a></td>
    </tr>
    <tr>
      <td valign="top">Previous Version</td>
      <td valign="top"><a href="http://www.unicode.org/reports/tr36/tr36-1.html">
      http://www.unicode.org/reports/tr36/tr36-1.html</a></td>
    </tr>
    <tr>
      <td valign="top">Latest Version</td>
      <td valign="top"><a href="http://www.unicode.org/reports/tr36/">
      http://www.unicode.org/reports/tr36/</a></td>
    </tr>
  </table>
  <h3><br>
  <i>Summary</i></h3>
  <p><i><span class="changedspan">Because Unicode contains such a large number of characters, and 
  because it incorporates the varied writing systems of the world, incorrect usage can expose 
  programs or systems to possible security attacks. This document describes some of the security 
  considerations that programmers, system analysts, standards developers, and users should take into 
  account, </span>and provides specific recommendations to reduce the risk of problems.</i></p>
  <p><span class="changedspan"><i>New text is marked with this style. This draft has rearranged a 
  number of pieces of text -- that rearrangement is not marked.</i></span></p>
  <p class="reviewnote"><span class="changedspan"><span style="background-color: #FFFF00"><i>Review 
  notes appear with this style. Editorial notes appear <b>[bold].</b></i></span></span></p>
  <h3><i>Status</i></h3>
  <p><i>This is a<b><font color="#ff3333"> draft </font></b>document which may be updated, replaced, 
  or superseded by other documents at any time. Publication does not imply endorsement by the 
  Unicode Consortium.&nbsp; This is not a stable document; it is inappropriate to cite this document 
  as other than a work in progress.</i></p>
  <blockquote>
    <p class="old_changed"><i><b>A Unicode Technical Report (UTR) </b>contains informative material. 
    Conformance to the Unicode Standard does not imply conformance to any UTR. Other specifications, 
    however, are free to make normative references to a UTR.</i></p>
  </blockquote>
  <p class="old_changed"><i>Please submit corrigenda and other comments with the online reporting 
  form [<a href="#Feedback">Feedback</a>]. Related information that is useful in understanding this 
  document is found in <a href="#References">References</a>. For the latest version of the Unicode 
  Standard see [<a href="#Unicode">Unicode</a>]. For a list of current Unicode Technical Reports see 
  [<a href="#Reports">Reports</a>]. For more information about versions of the Unicode Standard, see 
  [<a href="#Versions">Versions</a>].</i></p>
  <p><span class="changedspan"><i>The intent for this document to become a Unicode Technical 
  Standard. However, because of the current needs for referenceable data, </i></span></p>
  <p class="reviewnote">Based on feedback, the title was shortened to &quot;Unicode Security 
  Considerations&quot;.</p>
  <h3><i>Contents</i></h3>
  <ul class="toc">
    <li>1. <a href="#Introduction">Introduction</a><ul class="toc">
      <li>1.1 <a href="#Structure">Structure</a></li>
    </ul>
    </li>
    <li>2. <a href="#visual_spoofing">Visual Security Issues</a><ul class="toc">
      <li>2.1 <a href="#international_domain_names">Internationalized Domain Names</a></li>
      <li>2.2 <a href="#Cross_Script_Spoofing">Cross-Script Spoofing</a></li>
      <li>2.3 <a href="#In_Script_Spoofing">In-Script Spoofing</a></li>
      <li>2.4 <a href="#Inadequate_Rendering_Support">Inadequate Rendering Support</a></li>
      <li>2.5 <a href="#Syntax_Spoofing">Syntax Spoofing</a></li>
      <li>2.6 <a href="#Numeric_Spoofs">Numeric Spoofs</a></li>
      <li>2.7 <a href="#Case_Folded_Format">Case-Folded Format</a></li>
      <li><span class="changedspan">2.8 <a href="#Mapping_and_Prohibition">Mapping and Prohibition</a></span></li>
      <li><span class="changedspan">2.9 <a href="#Security_Levels_and_Alerts">Restriction Levels and 
      Alerts</a></span></li>
      <li>2.10 <a href="#Visual_Spoofing_Recommendations">Recommendations</a><ul class="toc">
        <li>2.10.4 <a href="#User_Recommendations">User Recommendations</a></li>
        <li>2.10.1 <a href="#Recommendations_General">General Programmer Recommendations</a></li>
        <li>2.10.2 <a href="#Recommendations_User_Agents">User Agent Recommendations</a></li>
        <li>2.10.3 <a href="#Recommendations_Registrars">Registry Recommendations</a></li>
      </ul>
      </li>
    </ul>
    </li>
    <li>3. <a href="#Canonical_Represenation">Non-Visual Security Issues</a><ul class="toc">
      <li>3.1 <a href="#UTF-8_Exploit">UTF-8 Exploit</a></li>
      <li>3.2 <a href="#Non_Visual_Recommendations">Recommendations</a></li>
    </ul>
    </li>
    <li><span class="changedspan">Appendix A. </span><a href="#Data_Files">Data Files</a></li>
    <li><span class="changedspan">Appendix B. </span><a href="#Related_Material">Related Material</a></li>
    <li><span class="changedspan">Appendix C. <a href="#Identifier_Characters">Identifier Characters</a></span></li>
    <li><span class="changedspan"><span style="background-color: #FFFF00">Appendix D.
    <a href="#Missing_Character_Glyphs">Missing Character Glyphs</a></span></span></li>
    <li><a href="#Acknowledgements">Acknowledgements</a></li>
    <li><a href="#References">References</a></li>
    <li><a href="#Modifications">Modifications</a></li>
  </ul>
  <hr>
  <h2 align="left"><a name="Introduction"></a>1. Introduction</h2>
  <p>Unicode represents a very significant advance over all previous methods of encoding characters. 
  For the first time, all of the world&#39;s characters could be represented in a uniform manner, for 
  the first time making it feasible for the vast majority of programs to be <i>globalized:</i> built 
  to handle any language in the world.</p>
  <p>In many ways, the use of Unicode makes programs much more robust and secure. When systems used 
  a hodge-podge of different charsets for representing characters, it was possible to take advantage 
  of differences between those charsets, or in the way in which programs converted to and from them.</p>
  <p>But because Unicode contains such a large number of characters, and because it incorporates the 
  varied writing systems of the world, incorrect usage can expose programs or systems to possible 
  security attacks. This document describes some of the security considerations that programmers, 
  system analysts, standards developers, and users should take into account.</p>
  <p>An example is visual spoofing, where a similarity in visual appearance fools a user, and causes 
  him or her to take unsafe actions. <span class="changedspan">Suppose that you get an email 
  notifying you that your paypal.com account has a problem. You, being a security-savvy user, 
  realize that it might be a spoof; the HTML email you get might be presenting the URL
  <a href="http://paypal.com/...">http://paypal.com/...</a> visually, but might be hiding the <i>
  real</i> URL. You realize that even what shows up in the status bar might be a lie, since clever 
  Javascript* or ActiveX can work around that. (And users may have these turned on unless they know 
  to turn them off.) So you click on the link, and carefully examine your browser&#39;s address box to 
  make sure that it is actually going to <a href="http://paypal.com/...">http://paypal.com/...</a>. 
  You see it is, and use your password. <i>But what you saw was wrong -- it is actually going to a 
  spoof site with a fake &quot;paypal.com&quot;, using the Cyrillic letter that looks precisely like a &#39;p&#39;.</i> 
  You use the site without suspecting, and your password ends up compromised.</span></p>
  <p>This problem is not new to Unicode: it was possible to spoof even with ASCII characters alone. 
  For example, &quot;<font face="sans-serif">inteI.com</font>&quot; uses a capital I instead of an L. The 
  infamous example here is of course &quot;<font face="sans-serif">paypaI.com</font>&quot;:&nbsp; </p>
  <blockquote>
    <p class="stBodyText">... Not only was &quot;Paypai.com&quot; very convincing, but the scam artist even 
    goes one step further. He or she is apparently emailing PayPal customers, saying they have a 
    large payment waiting for them in their account.</p>
    <p class="stBodyText">The message then offers up a link, urging the recipient to claim the 
    funds. But the URL that is displayed for the unwitting victim uses a capital &quot;i&quot; (I), which 
    looks just like a lowercase &quot;L&quot; (l), in many computer fonts. ...</p>
    <p class="stBodyText" align="right"><span class="h1">—
    <a href="http://news.zdnet.co.uk/internet/security/0,39020375,2080344,00.htm">Beware the &#39;PaypaI&#39; 
    scam</a></span></p>
  </blockquote>
  <p><span class="changedspan">While some browsers prevent this spoof by lowercasing domain names, 
  some other browsers don&#39;t.</span></p>
  <p>Thus to a certain extent, the new forms of visual spoofing available with Unicode are a matter 
  of degree and not kind. However, because of the very large number of Unicode characters (over 
  96,000 in the current version), the number of opportunities for visual spoofing is significantly 
  larger than with a restricted character set such as ASCII.</p>
  <h3>1.1 <a name="Structure">Structure</a></h3>
  <p>We anticipate that this document will grow over time, adding additional sections as needed. 
  Initially, it is organized into two section: visual security issues and non-visual security 
  issues. For more information, see also the Unicode
  <a href="http://www.unicode.org/faq/security.html">FAQ on Security Issues</a>.</p>
  <p><span>Each section presents background information on the kinds of problems that can occur, 
  then lists specific recommendations for reducing the risk of such problems.</span></p>
  <blockquote>
    <p class="reviewnote">Some of the examples below use Unicode characters which some browsers will 
    not show, or may not show in a way that illustrates the problem. For more information about 
    improving the display, see [<a href="#Display">Display</a>]. In the final version, we&#39;ll prepare 
    GIFs for the characters where necessary.</p>
  </blockquote>
  <h2><a name="visual_spoofing"></a>2. Visual Security Issues</h2>
  <p>Visual<span> spoofs depend on the use of <i>visually confusable</i> strings: two different 
  strings of Unicode characters whose appearance in common fonts in small sizes at screen 
  resolutions is sufficiently close that people easily mistake one for the other.</span></p>
  <p><span>There are no hard-and-fast rules for visual confusability: it is of course possible to 
  make any characters look like any others with a suitably faulty font. &quot;Small-sizes at screen 
  resolutions&quot;, means fonts whose ascent + descent is from 9 to 12 pixels for most scripts, somewhat 
  larger for scripts where the font size users typically have is larger, such as Japanese. Of 
  course, at sufficiently small sizes, such as 4 pixels for ascent + descent, a great many 
  characters would become confusable. In some cases sequences of characters can be used to spoof: 
  for example, &quot;rn&quot; (&quot;r&quot; followed by &quot;n&quot;) is visually confusable with &quot;m&quot; in many sans-serif fonts.</span></p>
  <p><span>Where two different strings are essentially identical in most fonts at all sizes, they 
  are called <i>homographs</i>. However, spoofing is not dependent on just homographs; if the visual 
  appearance is close enough at small sizes, that can be sufficient to cause problems.
  <span class="changedspan">Note that some people use the term <i>homograph</i> broadly, 
  encompassing all visually confusables.</span></span></p>
  <p><span>Note that characters are not visually confusable if the positioning of the glyph is 
  sufficiently different. For example, foo</span><span title="U+00B7 MIDDLE DOT">·</span><span>com 
  (using the hyphenation point instead of the period) should be distinguishable from foo.com by the 
  positioning of the dot (except in faulty fonts). For examples of visually confusable characters, 
  see [<a href="#confusables">confusables</a>].</span></p>
  <p class="reviewnote"><span class="changedspan"><b>[restructure so as to have general discussion 
  and recommendations first, then specifics for IDN. Add other examples outside of IDN.]</b></span></p>
  <h3>2.1 <a name="international_domain_names"></a>Internationalized Domain Names</h3>
  <p>Visual spoofing is an especially important subject given the recent introduction of 
  Internationalized Domain Names (IDN). There is a natural desire for people to see domain names in 
  their own languages and writing systems; English speakers can understand this if they consider 
  what it would be like if they always had to type web addresses with Russian characters! So IDN 
  represents a very significant advance for most people in the world. The avoidance of spoofing 
  vulnerabilities requires proper implementation in browsers and other programs, <span>to minimize 
  security risks while still allowing for effective use of non-ASCII characters.</span></p>
  <p>Internationalized Domain Names are, of course, not the only cases where visual spoofing can 
  occur. For example, you might get a message asking you to allow the installation of software from 
  &quot;IBM&quot;, authenticated with the proper Verisign certificate, but the &quot;<span title="U+041C CYRILLIC CAPITAL LETTER EM">М</span>&quot; 
  character happens to be the Russian (Cyrillic) character that looks precisely like the English 
  &quot;M&quot;. <span><i>Any place where strings are used as identifiers is subject to this kind of spoofing.</i> 
  For more information on identifiers, see <a href="http://www.unicode.org/reports/tr31/">UAX #31:
  <i>Identifier and Pattern Syntax</i></a>.</span></p>
  <p>However, IDN provides a good starting point for a discussion of visual spoofing. Fortunately 
  the design of IDN prevents a huge number of spoofing attacks. All conformant users of IDN are 
  required to process domain names to convert <span class="changedspan">what are called </span><i>
  <a href="http://www.unicode.org/glossary/#compatibility_equivalent">compatibility-equivalent</a></i> 
  characters into a unique form<span class="changedspan"> using a process called compatibility 
  normalization (NFKC) — for more information on this, see [<a href="#UAX15">UAX15</a>]</span>. This 
  processing eliminates most of the possibilities for visual spoofing by mapping away a large number 
  of visually confusable characters and sequences. For example, Unicode contains the &quot;<span title="U+00E4 LATIN SMALL LETTER A WITH DIAERESIS">ä</span>&quot; 
  (a-umlaut) character, but also contains a free-standing umlaut (&quot;<span title="U+0308 COMBINING DIAERESIS">&nbsp; 
  ̈</span>&quot;) which can be used in combination with any character, including an &quot;a&quot;. But the 
  compatibility normalization will convert any sequence of &quot;a&quot; plus &quot;<span title="U+0308 COMBINING DIAERESIS">&nbsp; 
  ̈</span>&quot; into the regular &quot;<span title="U+00E4 LATIN SMALL LETTER A WITH DIAERESIS">ä</span>&quot;.
  <span class="changedspan">It will also convert characters like the half-width Japanese <i>katakana</i> 
  character <span title="U+FF76 HALFWIDTH KATAKANA LETTER KA">ｶ</span><span title="U+30AB KATAKANA LETTER KA"> 
  to the regular character カ, and single ligature characters like </span>
  <span title="U+FB01 LATIN SMALL LIGATURE FI">&quot;ﬁ&quot; to the regular characters &quot;fi&quot;.</span></span></p>
  <p>Thus you can not spoof an <i>a-umlaut</i> with <i>a + umlaut</i>; it simply results in the same 
  domain name. See the example <i>Safe Domain Names </i>below. The String column shows the actual 
  characters; the UTF-16 shows the underlying encoding<span class="changedspan">, while the ACE 
  (&quot;ASCII Compatible Encoding&quot;) column shows the internal format of the domain name. This is the 
  result of applying the ToASCII() operation [<a href="#RFC3490">RFC3490</a>] to the original IDN, 
  which is the way this IDN is stored and queried in the DNS (Domain Name System).</span></p>
  <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold"><b>Safe Domain Names</b></caption>
    <tr>
      <th class="idn-head">&nbsp;</th>
      <th class="idn-head">String</th>
      <th class="idn-head">UTF-16</th>
      <th class="idn-head"><span class="changedspan">ACE</span></th>
      <th class="idn-head"><span class="changedspan">Comments</span></th>
    </tr>
    <tr>
      <th class="idn-head">1a</th>
      <td class="idn-example">ät.com</td>
      <td class="mono"><span class="special">0061 0308</span><span class="mono"> 0074 002E 0063 006F 
      006D</span></td>
      <td><span class="mono">xn--t-zfa.com</span></td>
      <td class="idn-example"><span class="changedspan">Uses the decomposed form, a + umlaut</span></td>
    </tr>
    <tr>
      <th class="idn-head">1b</th>
      <td class="idn-example">ät.com</td>
      <td class="mono"><span class="special">00E4</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
      <td class="mono"><span class="mono">xn--t-zfa.com</span></td>
      <td class="idn-example"><span class="changedspan">But it ends up being identical to the 
      composed form, in IDNA</span></td>
    </tr>
  </table>
  <blockquote>
    <p><b>Note: </b>The ICU demo at <span class="changedSpan">[<a href="#IDN-Demo">IDN-Demo</a>]</span> 
    can be used to demonstrate the results of processing different domain names. That demo was also 
    used to get the IDNA values shown here.</p>
  </blockquote>
  <p><span class="changedspan">Similarly, for<span title="U+0906 DEVANAGARI LETTER AA"> most 
  scripts, when the text is normalized, two accents that don&#39;t interact typographically are put into 
  a determinate order. Thus the sequence &lt;x, dot_above, dot_below&gt; is reordered as &lt;x, dot_below, 
  dot_above&gt;. This ensures that the two sequences that look ide</span>ntical (ẋ̣ and ẋ̣̇) have the 
  same representation.</span></p>
  <p><span>The IDN processing also removes case distinctions by performing a <i>case folding</i> to 
  reduce characters to a lowercase form<i>.</i> This is also useful for avoiding spoofing problems, 
  since characters are generally more distinctive in their lowercase forms. That means that we can 
  focus on just the lowercase characters.</span></p>
  <blockquote>
    <p><span class="changedspan">This focus on lowercase letters only really helps for <i>
    Internationalized</i> Domain Names, because of two factors: First, the IDNA operation ToASCII() 
    will map to lowercase if and only if the label contains some non-ASCII character. Thus 
    ToASCII(&quot;paypaI.com&quot;) = &quot;paypaI.com&quot; (where the &#39;I&#39; is a capital &#39;i&#39;).</span></p>
    <p><span class="changedspan">Secondly, domain names are case-insensitive, but [<a href="#RFC1034">RFC1034</a>] 
    and [<a href="#RFC1035">RFC1035</a>], as clarified by [<a href="#DNS-Case">DNS-Case</a>], 
    introduce the concept of case preservation. Thus if someone queries the DNS for &quot;paypaI.com&quot;, 
    and the DNS contains information for &quot;paypai.com&quot;, that information is delivered, but the answer 
    from the DNS will be the original &quot;paypaI.com&quot;.</span></p>
  </blockquote>
  <p><span>For a list of allowable characters in IDN, see [<a href="#idn-chars">idn-chars</a>]. 
  There are many misperceptions about which characters are allowed in IDN, so referencing this 
  explicit list should help dispel some of them.</span></p>
  <blockquote>
    <p><span class="changedspan"><b>Note</b>: Users expect diacritical marks to distinguish domain 
    names. For example, the domain names &quot;resume.com&quot; and &quot;résumé.com&quot; are (and should be) 
    distinguished. In languages where the spelling may allow certain words with and without 
    diacritics, two domain names would need to be registered (just as one may register both &quot;analyze.com&quot; 
    and &quot;analyse.com&quot;).</span></p>
  </blockquote>
  <p><span>Although normalization and case-folding prevent many possible spoofing attacks, </span>
  visual spoofing can still occur with many Internationalized Domain Names. Some<span> of this can 
  be handled on the registry side instead of the user-agent side (browsers, emailers, and other 
  programs that display and process URLs). The registry has the most data available about 
  alternative registered names, and can process that information the most efficiently at the time of 
  registration, using policies to reduce visual spoofing. For example, given confusable mapping data
  <span class="changedspan">described below</span>, the registry can easily determine if a proposed 
  registration conflicts with an existing one; that is much more difficult for user agents because 
  of the sheer number of combinations that they would have to probe.</span></p>
  <p><span>However:</span></p>
  <ul>
    <li><span>the user agent has more control over the display of characters, which is crucial to 
    spoofing</span></li>
    <li><span>there are legitimate cases of visually confusable characters that one may want to 
    allow <i>after</i> alerting the user<span class="changedspan">, such as whole-script confusables 
    discussed below</span>.</span></li>
    <li><span>one cannot depend on all registries being equally responsive to security issues</span></li>
    <li><span class="changedspan">Due to the decentralized nature of DNS, registries do not control 
    subdomains being established beyond the domain name registered (see [<a href="#RFC1535">RFC1535</a>])</span></li>
  </ul>
  <p><span>So efforts need to be made on the part of user-agents as an additional line of defense.</span></p>
  <blockquote>
    <p><span><b>Note: </b>since the top-level domain names (TLD: .com, .ru, etc.) are currently 
    always ASCII, all discussions below of the domain names pertain to all but the top level.</span></p>
    <p class="reviewnote"><b>[Clarify this, use &#39;core&#39; definition.]</b></p>
  </blockquote>
  <h3><b>2.2 <a name="Cross_Script_Spoofing">Cross-Script Spoofing</a></b></h3>
  <p>Visually confusable characters are not usually unified across scripts. Thus a Greek <i>omicron</i> 
  is encoded as a different character from the Latin &quot;o&quot;, even though it is usually identical <span>
  or nearly identical</span> in appearance. <span>There are good reasons for this: often the 
  characters were separate in legacy encodings, and preservation of those distinctions was necessary 
  for existing data to be mapped to Unicode without loss. Moreover, the characters generally have 
  very different behavior: two visually confusable characters may be different in casing behavior, 
  in category (letter versus number), or in numeric value. After all, ASCII does not unify lowercase 
  letter l and digit 1, even though those are visually confusable. <span class="changedspan">(Many 
  fonts always distinguish them, but many do not.) </span>Encoding the Cyrillic character б 
  (corresponding to the letter &quot;b&quot;) by using the numeral 6, would clearly have been a mistake, even 
  though they are visually confusable.</span></p>
  <p><span>However, the existence of v</span>isually confusable characters across scripts<span>
  </span>means that there is a significant number of spoofing possibilities using characters from 
  different scripts. For example, a domain name can be spoofed by using a Greek omicron instead of 
  an &#39;o&#39;, as in example 2a.</p>
  <table id="AutoNumber2" style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold"><b>Cross-Script Spoofing</b></caption>
    <tr>
      <th class="idn-head">&nbsp;</th>
      <th class="idn-head">String</th>
      <th class="idn-head">UTF-16</th>
      <th class="idn-head"><span class="changedspan">ACE</span></th>
      <th class="idn-head"><span class="changedspan">Comments</span></th>
    </tr>
    <tr>
      <th class="idn-head">2a</th>
      <td class="idn-example">tοp.com</td>
      <td><span class="mono">0074 </span><span class="special">03BF</span><span class="mono"> 0070 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--tp-jbc.com</span></td>
      <td class="idn-example"><span class="changedspan">Uses a Greek omicron in place of the o</span></td>
    </tr>
    <tr>
      <th class="idn-head">2b</th>
      <td class="idn-example">tοp.com</td>
      <td><span class="mono">0074 </span><span class="special">006F</span><span class="mono"> 0070 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">top.com</span></td>
      <td class="idn-example">&nbsp;</td>
    </tr>
  </table>
  <p>There are many legitimate uses of mixed scripts. For example, <span>the prevalence of Latin 
  characters means that it</span> is quite common to use English words (with Latin characters) in 
  the middle of other languages using other scripts. <span>For example, one could have XML-документы.com 
  (which would be a site for &quot;XML documents&quot; in Russian). Even in English, legitimate product or 
  organization names may contain non-Latin characters, such as Ωmega, Teχ, Toys-Я-Us, or HλLF-LIFE. 
  The lack of IDNs in the past has also led to the usage in some registries (such as the .ru TLD) 
  where Latin characters have been used to create pseudo-Cyrillic names in the .ru (Russian) 
  top-level domain. For example, see <a href="http://caxap.ru/">http://caxap.ru/</a> (сахар means 
  sugar in Russian)</span>.</p>
  <p>The Unicode Standard supplies information that can be used for detecting mixed-script text. For 
  more information, see [<a href="#UAX24">UAX24</a>].</p>
  <p><span>Cyrillic and Latin represent special challenges, since the number of common glyphs shared 
  between them is so high, as can be seen from [<a href="#idn-chars">idn-chars</a>]. It may be 
  possible to compose an entire domain name (except the TLD) in Cyrillic using letters that will be 
  essentially always identical in form to Latin letters, such as &quot;scope.com&quot;: with &quot;scope&quot; in 
  Cyrillic looking just like &quot;scope&quot; in Latin. These are called <i>whole-script confusables.</i></span></p>
  <p class="reviewnote"><span class="changedspan"><b>[separate out whole-script confusables into 
  separate section; point out different usages in Appendix C]</b></span></p>
  <h3>2.3 <a name="In_Script_Spoofing">In-Script Spoofing</a></h3>
  <p>The use of characters entirely within one script, or using characters that are common across 
  scripts is called <i>in-script</i> spoofing, and the strings that cause it are correspondingly 
  called in-script confusables. While compatibility normalization and mixed-script detection can 
  handle the majority of cases, they do not handle in-script confusables. <i>Especially</i> at the 
  smaller font sizes in the context of an address bar, any visual confusables within a single script 
  can be used in spoofing. Importantly, these problems can be illustrated with common, widely 
  available fonts on widely available operating systems — the problems are not specific to any 
  single vendor.</p>
  <p>Consider the following examples, all in the same script. In each numbered case, in commonly 
  available browsers, the strings will look identical or close to identical.</p>
  <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold"><b>Spoofed Domain Names</b></caption>
    <tr>
      <th class="idn-head">&nbsp;</th>
      <th class="idn-head">String</th>
      <th class="idn-head">UTF-16</th>
      <th class="idn-head"><span class="changedspan">ACE</span></th>
      <th class="idn-head"><span class="changedspan">Comments</span></th>
    </tr>
    <tr>
      <th class="idn-head">3a</th>
      <td class="idn-example">a‐b.com</td>
      <td><span class="mono">0061 </span><span class="special">2010</span><span class="mono"> 0062 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ab-v1t.com</span></td>
      <td class="idn-example"><span class="changedspan">Uses a real hyphen, instead of the ASCII 
      hyphen-minus</span></td>
    </tr>
    <tr>
      <th class="idn-head">3b</th>
      <td class="idn-example">a-b.com</td>
      <td><span class="mono">0061 </span><span class="special">002D</span><span class="mono"> 0062 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">a-b.com</span></td>
      <td class="idn-example">&nbsp;</td>
    </tr>
    <tr>
      <th colSpan="5" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">4a</th>
      <td class="idn-example">so̷s.com</td>
      <td><span class="mono">0073 </span><span class="special">006F 0337</span><span class="mono"> 
      0073 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--sos-rjc.com</span></td>
      <td class="idn-example"><span class="changedspan">Uses o + combining slash</span></td>
    </tr>
    <tr>
      <th class="idn-head">4b</th>
      <td class="idn-example">søs.com</td>
      <td><span class="mono">0073 </span><span class="special">00F8</span><span class="mono"> 0073 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ss-lka.com</span></td>
      <td class="idn-example">&nbsp;</td>
    </tr>
    <tr>
      <th colSpan="5" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">5a</th>
      <td class="idn-example">z̵o.com</td>
      <td><span class="special">007A 0335</span><span class="mono"> 006F 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--zo-pyb.com</span></td>
      <td class="idn-example"><span class="changedspan">Uses z + combining bar</span></td>
    </tr>
    <tr>
      <th class="idn-head">5b</th>
      <td class="idn-example">ƶo.com</td>
      <td><span class="special">01B6</span><span class="mono"> 006F 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--o-zra.com</span></td>
      <td class="idn-example">&nbsp;</td>
    </tr>
    <tr>
      <th colSpan="5" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">6a</th>
      <td class="idn-example">an͂o.com</td>
      <td><span class="mono">0061 </span><span class="special">006E 0342</span><span class="mono"> 
      006F 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ano-0kc.com</span></td>
      <td class="idn-example"><span class="changedspan">Uses n + greek perispomeni</span></td>
    </tr>
    <tr>
      <th class="idn-head">6b</th>
      <td class="idn-example">año.com</td>
      <td><span class="mono">0061 </span><span class="special">00F1</span><span class="mono"> 006F 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ao-zja.com</span></td>
      <td class="idn-example">&nbsp;</td>
    </tr>
    <tr>
      <th colSpan="5" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">7a</th>
      <td class="idn-example"><span class="changedspan">
      <span title="U+02A3 LATIN SMALL LETTER DZ DIGRAPH">ʣe</span>.org</span></td>
      <td><span class="special">02A3</span><span class="mono"><span class="changedspan"> 0065 002E 
      006F 0072 0067</span></span></td>
      <td><span class="changedspan"><span class="mono">xn--e-j5a.org</span></span></td>
      <td class="idn-example"><span class="changedspan">Uses d-z digraph</span></td>
    </tr>
    <tr>
      <th class="idn-head">7b</th>
      <td class="idn-example"><span class="changedspan">dze.org</span></td>
      <td><span class="special">0064 007A</span><span class="mono"><span class="changedspan"> 0065 
      002E 006F 0072 0067</span></span></td>
      <td><span class="changedspan"><span class="mono">dze.org</span></span></td>
      <td class="idn-example">&nbsp;</td>
    </tr>
  </table>
  <p><span class="changedspan">There are other examples where sequences cause problems. The example 
  of &quot;rn&quot; is mentioned above; there are other examples in other scripts. For example, the sequence
  <span title="U+0905 DEVANAGARI LETTER A">अ</span> + <span title="U+093E DEVANAGARI VOWEL SIGN AA">
  ा</span> typically looks identical to <span title="U+0906 DEVANAGARI LETTER AA">आ.</span></span></p>
  <p><span class="changedspan"><span style="background-color: #FFFF00">As mentioned above, in most 
  cases two sequences of accents that have the same visual appearance are put into a canonical 
  order. This does not happen, however, for certain scripts used in Southeast Asia, so reordering 
  characters may be used for spoofs in those cases.</span></span></p>
  <p class="reviewnote"><span class="changedspan">
  <span style="font-weight: 700; background-color: #FFFF00">[add example]</span></span></p>
  <h3>2.4 <a name="Inadequate_Rendering_Support">Inadequate Rendering Support</a></h3>
  <p>An additional problem arises when a font and/or rendering engine has inadequate support for 
  certain sequences of characters. These are characters that <i>should</i> be visually 
  distinguishable, but do not appear that way. In example 8a, the <i>a-umlaut</i> is followed by 
  another <i>umlaut</i>. The Unicode Standard guidelines indicate that the second <i>umlaut</i> 
  should be &#39;stacked&#39; above the first, producing a distinct visual difference. But as this example 
  shows, common fonts will simply superimpose the second <i>umlaut</i>; and if the positioning is 
  close enough, the user will not see a difference between 8a and 8b.</p>
  <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold">Inadequate Rendering Support </caption>
    <tr>
      <th bgColor="#c0c0c0" class="idn-head">&nbsp;</th>
      <th bgColor="#c0c0c0" class="idn-head">String</th>
      <th bgColor="#c0c0c0" class="idn-head">UTF-16</th>
      <th bgColor="#c0c0c0" class="idn-head"><span class="changedspan">ACE</span></th>
      <th bgColor="#c0c0c0" class="idn-head">Comments</th>
    </tr>
    <tr>
      <th class="idn-head">8a</th>
      <td><span class="mono">ä<font face="Arial Unicode MS">̈</font>t.com</span></td>
      <td><span class="special">00E4 0308</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--t-zfa85n.com</span></td>
      <td><span class="idn-example"><span style="background-color: #FFFF00">a-umlaut + umlaut</span></span></td>
    </tr>
    <tr>
      <th class="idn-head">8b</th>
      <td><span class="mono">ät.com</span></td>
      <td><span class="special">00E4</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--t-zfa.com</span></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <th bgColor="#c0c0c0" colSpan="5" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">9a</th>
      <td><span class="mono">eḷ.com</span></td>
      <td><span class="special">0065</span><span class="mono"> 006C </span><span class="special">
      0323</span><span class="mono"> 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--e-zom.com</span></td>
      <td><span class="idn-example"><span style="background-color: #FFFF00">Has a dot under the l; 
      may appear under the e</span></span></td>
    </tr>
    <tr>
      <th class="idn-head">9b</th>
      <td><span class="mono">ẹl.com</span></td>
      <td><span class="special">0065 0323</span><span class="mono"> 006C 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--l-ewm.com</span></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <th class="idn-head">9c</th>
      <td><span class="mono">ẹl.com</span></td>
      <td><span class="special">1EB9</span><span class="mono"> 006C 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--l-ewm.com</span></td>
      <td>&nbsp;</td>
    </tr>
  </table>
  <p>In example 9, we have an even worse case. The <i>underdot</i> character in 9a is <i>actually</i> 
  under the &#39;l&#39;, but in many fonts, it appears as under the &#39;e&#39;! It is thus visually confusable with 
  9b (where the <i>underdot</i> is under the e) or the equivalent normalized form 9c.</p>
  <p class="reviewnote"><b>[add 1 (one) and l (lowercase L) to this table]</b></p>
  <p class="reviewnote"><b>Add discussion of other areas: Ideographic Description Characters, 
  Invisible characters (Default Ignorable)</b></p>
  <p class="reviewnote"><b>Get section from Michel on BIDI issues]</b></p>
  <h3><span>2.5 <a name="Syntax_Spoofing">Syntax Spoofing</a></span></h3>
  <p><span>Spoofing syntax characters can be even worse than regular characters. For example, U+2044 
  ( <span title="U+2044 FRACTION SLASH">⁄ ) <span style="font-variant: small-caps">FRACTION SLASH</span> 
  can look like <span class="changedspan">a regular ASCII</span> &#39;/&#39; in many fonts (ideally the 
  spacing and angle is sufficiently different as to be distinguishable, but this is not always 
  maintained. </span>This allows the following name:</span></p>
  <blockquote>
    <p><span>http://example.org/not.mydomain.com</span></p>
  </blockquote>
  <p><span>to pretend to be <span class="changedspan">a URL under the domain</span> </span></p>
  <blockquote>
    <p><span>http://example.org</span></p>
  </blockquote>
  <p><span>whereas it is actually the subzone <i>&quot;example.org/not&quot;</i> in the domain</span></p>
  <blockquote>
    <p>http://<span>mydomain.com</span></p>
  </blockquote>
  <p><span>Thus anything that is visually similar to &#39;.&#39;, &#39;/&#39;, &#39;#&#39;, is especially dangerous. Most of 
  these cases, such as U+2024 (·) <span style="font-variant: small-caps">ONE DOT LEADER</span> are 
  disallowed by StringPrep [<a href="#RFC3454">RFC3454</a>], but not all.</span></p>
  <p><span class="changedSpan">Of course, this approach can also work even without IDN, where the 
  user is fooled into thinking that the domain name is the first part of the URL, not where it 
  actually is. For example, in the following the real domain name, mydomain.com, is also obscured 
  for the casual user, who may not realize that -- does not terminate the domain name.</span></p>
  <blockquote>
    <p><span class="changedSpan"><span>http://example.org</span>--long-and-obscure-list-of-characters.<span>mydomain.com</span></span></p>
  </blockquote>
  <p><span class="changedSpan">In retrospect, it would have been much better if domain names were 
  customarily written with &quot;most significant part first&quot;. The following <i>hypothetical</i> display 
  would be harder to spoof: the fact that it is &quot;com.mydomain&quot; is not as easily lost.</span></p>
  <blockquote>
    <p><span class="changedSpan"><span>http://com.mydomain.org/not.example<br>
    http://com.mydomain.org</span>--long-and-obscure-list-of-characters.<span>example</span></span></p>
  </blockquote>
  <p><span class="changedSpan"><span>But that would be an impossible change at this point: those 
  horses have long since left the barn. However, a possible solution is to always visually 
  distinguish the second-level domain, for example:</span></span></p>
  <blockquote>
    <p><span class="changedSpan"><span>http://<b><font color="#0000FF">example</font></b>.org</span><br>
    http://<span><b><font color="#0000FF">mydomain</font></b>.com</span><br>
    <span>http://example.org/not.<b><font color="#0000FF">mydomain</font></b>.com</span><br>
    <span>http://example.org</span>--long-and-obscure-list-of-characters.</span><span><span class="changedSpan"><b><font color="#0000FF">mydomain</font></b>.com</span></span></p>
  </blockquote>
  <p><span class="changedspan">As it turns out, some registries register at the third-level (such as
  <b>nominet</b>.org.uk), and there&#39;s no rule that forbids a TLD to register at the fourth, fifth. 
  So the user-agent needs to know which is the &quot;core&quot; level to distinguish.</span></p>
  <p><span>It is important also not to show a missing glyph or character with a simple &quot;?&quot;, since 
  that makes every such character be visually confusable with a real question mark. Instead, follow 
  the Unicode guidelines for displaying missing glyphs using a rounded-rectangle, as described in 
  Section <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.3 <i>Unknown and Missing 
  Characters</i></a> of [<a href="#Unicode">Unicode</a>].&nbsp; For examples of this, see also [<a href="#Charts">Charts</a>].</span></p>
  <p class="reviewnote"><b>[Add example of IP address at start].</b></p>
  <h3><span>2.6 <a name="Numeric_Spoofs">Numeric Spoofs</a></span></h3>
  <p><span>Turning away from IDN for a moment, there is another area where visual spoofs can be 
  used. Many scripts have sets of decimal digits that are different in shape from the typical 
  European digits {0 1 2 3 4 5 6 7 8 9}. For example, Bengali has
  <span title="U+09E6 BENGALI DIGIT ZERO">{০ </span><span title="U+09E7 BENGALI DIGIT ONE">১</span><span title="U+09F4 BENGALI CURRENCY NUMERATOR ONE">
  </span><span title="U+09E8 BENGALI DIGIT TWO">২</span><span title="U+09F5 BENGALI CURRENCY NUMERATOR TWO">
  </span><span title="U+09E9 BENGALI DIGIT THREE">৩ </span><span title="U+09EA BENGALI DIGIT FOUR">৪
  </span><span title="U+09EB BENGALI DIGIT FIVE">৫ </span><span title="U+09EC BENGALI DIGIT SIX">৬
  </span><span title="U+09ED BENGALI DIGIT SEVEN">৭ </span><span title="U+09EE BENGALI DIGIT EIGHT">
  ৮ </span><span title="U+09EF BENGALI DIGIT NINE">৯}, while Oriya has </span>{<span title="U+0B66 ORIYA DIGIT ZERO">୦
  </span><span title="U+0B67 ORIYA DIGIT ONE">୧ </span><span title="U+0B68 ORIYA DIGIT TWO">୨ </span>
  <span title="U+0B69 ORIYA DIGIT THREE">୩ </span><span title="U+0B6A ORIYA DIGIT FOUR">୪ </span>
  <span title="U+0B6B ORIYA DIGIT FIVE">୫ </span><span title="U+0B6C ORIYA DIGIT SIX">୬ </span>
  <span title="U+0B6D ORIYA DIGIT SEVEN">୭ </span><span title="U+0B6E ORIYA DIGIT EIGHT">୮ </span>
  <span title="U+0B6F ORIYA DIGIT NINE">୯}. While the sets taken as a whole are different in shape, 
  individual digits may have the same shapes as digits from other scripts, even digits of different 
  values. For example, the string </span><b><span title="U+09EA BENGALI DIGIT FOUR">৪</span></b><span title="U+0B68 ORIYA DIGIT TWO"><b>୨</b> 
  is visually confusable with <b>89</b> (at small sizes), but actually has the numeric value 42! 
  Where software interprets the numeric value of a string of digits without detecting that the 
  digits are from different scripts, it is possible to generate such spoofs.</span></span></p>
  <p class="reviewnote"><b>[Put 2.7 and 2.8 in section called Techniques]</b></p>
  <h3><span class="changedspan">2.7 <a name="Case_Folded_Format">Case-Folded Format</a></span></h3>
  <p><span class="changedspan">Many opportunities for spoofing can be removed by using a <i>
  case-folded</i> format. This format, defined by the Unicode Standard, produces a string that only 
  contains lowercase characters where possible.</span></p>
  <p><span class="changedspan">However, there is one particular situation where the pure case-folded 
  format of a string as defined by the standard is not desired. The character U+03A3 &quot;Σ&quot; <i>capital 
  sigma</i> lowercases to U+03C3 &quot;σ&quot; <i>small sigma</i> if it is followed by another letter, but 
  lowercases to U+03C2 &quot;ς&quot; <i>small final sigma</i> if it is not. Because both σ and ς have a 
  case-insensitive match to Σ, and the case folding algorithm needs to map both of them together (so 
  that transitivity is maintained), only one of them appears in the case-folded form.</span></p>
  <p><span class="changedspan">When the case-folded format of a Greek string is to be displayed to 
  the user, it should be processed so as to choose the proper form for the small sigma, depending on 
  the context. That is provided in Table 3-13 of [<a href="#Unicode">Unicode</a>], where C = σ.
  </span></p>
  <p class="reviewnote"><b><span class="changedspan">[Fix reference, supply more details.]</span></b></p>
  <p><span class="changedspan">For more information on case mapping and folding, see the following: 
  Section <a href="http://www.unicode.org/versions/Unicode4.0.0/ch03.pdf#G33992">3.13 Default Case 
  Operations</a> of [<a href="#Unicode">Unicode</a>], Section
  <a href="http://www.unicode.org/versions/Unicode4.0.0/ch04.pdf#G124722">4.2 Case Normative</a> of 
  [<a href="#Unicode">Unicode</a>], and Section
  <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf#G21180">5.18 Case Mappings</a> of [<a href="#Unicode">Unicode</a>].</span></p>
  <h3><span class="changedspan">2.8 <a name="Mapping_and_Prohibition">Mapping and Prohibition</a></span></h3>
  <p><span class="changedspan">A number of characters are included in Unicode for compatibility. 
  What is called <i>Compatibility Normalization</i> (NFKC) can be used to map these characters to 
  the regular variants (this is what is done in IDNA). For example, a half-width Japanese <i>
  katakana</i> character <span title="U+FF76 HALFWIDTH KATAKANA LETTER KA">ｶ</span><span title="U+30AB KATAKANA LETTER KA"> 
  is mapped to the regular character カ. Additional mappings can be added to this, for example, IDNA 
  adds additional mappings such as:</span></span></p>
  <p><span class="changedspan"><code>200D; ZERO WIDTH JOINER</code> maps to nothing (that is, is 
  removed)<br>
  <code>0041; 0061;</code> Case maps &#39;A&#39; to &#39;a&#39;<br>
  <code>20A8; 0072 0073;</code> Additional folding, mapping <span title="U+20A8 RUPEE SIGN">₨</span> 
  to &quot;rs&quot;</span></p>
  <p><span class="changedspan">In addition, characters may be prohibited. For example, IDNA 
  prohibits <span title="U+0384 GREEK TONOS"><i>space</i> </span>and <i>no-break s</i><span title="U+0384 GREEK TONOS"><i>pace</i> 
  (U+00A0)</span>. Instead, for example, of removing a ZERO WIDTH JOINER, or mapping
  <span title="U+20A8 RUPEE SIGN">₨</span> to &quot;rs&quot;, one could prohibit these characters. There are 
  pluses and minuses to both approaches. If compatibility characters are widely used in practice, in 
  entering text, then it is much more user-friendly to remap them. This also extends to deletion; 
  for example, the ZERO WIDTH JOINER is commonly used to affect the presentation of characters in 
  languages such as Hindi or Arabic. In this case, text copied into the address box may often 
  contain the character.</span></p>
  <p><span class="changedspan">Where this is not the case, however, it may be advisable to simply 
  prohibit the character. It is unlikely, for example, that <span title="U+32D5 CIRCLED KATAKANA KA">
  ㋕ would be typed by a Japanese user, nor that it need work in copied text.</span></span></p>
  <p><span class="changedspan">Where both mapping and prohibition are used, the mapping should be 
  done before the prohibition, to ensure that characters don&#39;t &quot;sneak past&quot;. For example, the Greek 
  character TONOS <span title="U+0384 GREEK TONOS">(΄) ends up being prohibited, because it 
  normalizes to <i>space + acute</i>, and <i>space</i> ends up being prohibited.</span></span></p>
  <h4><span class="changedspan"><span style="background-color: #FFFF00">2.9
  <a name="Security_Levels_and_Alerts">Restriction Levels and Alerts</a></span></span></h4>
  <p><span class="changedspan"><span>The Restriction Levels 1-5 are defined below for use in 
  implementations. These place restrictions on the use of identifiers according to the recommended
  </span>Identifier Characters <span>as specified in </span><a href="#Identifier_Characters">
  Appendix C</a><span>. The Special-Purpose Characters are also specified in that appendix.</span></span></p>
  <ol>
    <li><b>ASCII-Only</b><ul>
      <li>All characters in each identifier must be ASCII</li>
    </ul>
    </li>
    <li><b><span>Minimal</span></b><ul>
      <li>All characters in each identifier must be from a <span>single script, or from <i>Han + 
      Hiragana + Katakana</i>, or from <i>Han + Bopomofo</i>, or <i>Han + Hangul</i>, </span></li>
      <li>No characters in the identifier can be<span> Special-Purpose Characters</span></li>
    </ul>
    </li>
    <li><b><span>Moderate</span></b><ul>
      <li>A<span>llow <i>Latin</i> with other scripts except <i>Cyrillic</i>, <i>Greek</i>, <i>
      Cherokee</i></span></li>
      <li><span class="changedspan">Otherwise, the same as Minimal</span></li>
    </ul>
    </li>
    <li><b><span>Expanded</span></b><ul>
      <li>A<span>llow mixtures of scripts, e.g. Ωmega, Teχ, HλLF-LIFE, Toys &quot;</span><span title="U+042F CYRILLIC CAPITAL LETTER YA">Я</span><span>&quot; 
      Us</span></li>
      <li><span class="changedspan">Otherwise, the same as Moderate</span></li>
    </ul>
    </li>
    <li><b><span>Unrestricted</span></b><ul>
      <li>A<span>ny valid identifiers, including Special-Purpose Characters.</span></li>
    </ul>
    </li>
  </ol>
  <p><span class="changedspan"><span>The determination of Script is according to the Unicode 
  Standard [<a href="#UAX24">UAX24</a>]. (</span></span><span><span class="changedSpan">A visual 
  breakdown of characters by script is given in [<a href="#idn-chars">idn-chars</a>].) </span>
  </span>In determining script,<span> <i>Common</i> and <i>Inherited</i> script characters are 
  ignored<span class="changedspan">, except for non-Identifier Characters (</span></span><span class="changedspan">see
  <a href="#Identifier_Characters">Appendix C</a>)</span><span><span class="changedspan">. For 
  example, &quot;abc-def&quot; counts as a single script, and would be allowed at Restriction Level 2. That 
  is, the script of &quot;-&quot; is ignored. </span></span><span class="changedspan">The string &quot;I<span title="U+2665 BLACK HEART SUIT">♥</span>NY&quot;, 
  on the other hand, is first allowed at Restriction Level 4, since the heart character is outside 
  of the Identifier Characters, and thus the string counts as containing two scripts: Latin and 
  Common.</span></p>
  <p><span>An &quot;appropriate alert&quot; should be generated if a domain name fails to satisfy the chosen 
  Restriction Level. <span class="changedspan">Depending on the circumstances and the level 
  difference, t</span>he form of such alerts could be minimal, such as special coloring or icons 
  (perhaps with a tool-tip for more information); or more obvious, such as an alert dialog 
  describing the issue and requiring user confirmation before continuing<span class="changedspan">; 
  or even more stringent, such as disallowing the use of the identifier</span>. User-agents
  <span class="changedspan">should</span> remember when the user has accepted an alert, for say <i>
  Ωmega.com</i>, and permit future access without bothering the user again.
  <span class="changedspan">Where icons are used to indicate the presence of characters from 
  scripts, the glyphs in </span></span><span class="changedspan">
  <span style="background-color: #FFFF00">Appendix D. <a href="#Missing_Character_Glyphs">Missing 
  Character Glyphs</a> can be used.</span></span></p>
  <p class="reviewnote"><span class="changedSpan"><b>[Alert the user if the visual appearance of a 
  link goes to a different location [if it looks like a link]</b></span></p>
  <h3>2.10 <a name="Visual_Spoofing_Recommendations">Recommendations</a></h3>
  <p>The Unicode Consortium recommends a somewhat conservative approach at this point, because is 
  always easier to widen restrictions than narrow them. The Consortium is gathering data that would 
  allow for a finer-grained approach, and expects to refine these recommendations in the future.</p>
  <p><span>Some have proposed restricting domain names according to language, to prevent spoofing. 
  In practice, that is very problematic: it is very difficult to determine the intended language of 
  many terms, especially product or company names, which are often constructed to be neutral 
  regarding language. Moreover, languages tend to be quite fluid; foreign words are continually 
  being adopted. Except for registries with very special policies (such as the blocking used by some 
  East Asian registries such as described in [<a href="#RFC3743">RFC3743</a>]), the language 
  association does not make too much sense. </span></p>
  <p><span>Instead, the recommendations call for combination of string preprocessing to remove basic 
  equivalences, promoting adequate rendering support, and putting restrictions in place according to 
  script and restricting by confusable characters. While the ICANN guidelines say &quot;top-level domain 
  registries will ... associate each registered internationalized domain name with one language or 
  set of languages&quot; [<a href="#ICANN">ICANN</a>], that guidance is better interpreted as limiting to
  <i>script</i> rather than <i>language</i>.</span></p>
  <p><span>Also see the security discussions in IRI [<a href="#RFC3987">RFC3987</a>], URI [<a href="#RFC3986">RFC3986</a>], 
  and StringPrep [<a href="#RFC3454">RFC3454</a>].</span></p>
  <h4><b><span>2.10.1 <a name="User_Recommendations">User Recommendations</a></span></b></h4>
  <ol type="A">
    <li><span class="changedspan">Use browsers, mail clients and software in general that have put 
    user-agent guidelines into place to detect spoofing.</span></li>
    <li>If registering domain names, verify<span> that the registry follows appropriate guidelines 
    for preventing spoofing. </span>
    <p class="reviewnote"><span><b>[point to the IDN list for policies by country].</b></span></li>
    <li><span>If the desired domain name <span class="changedspan">can have</span> any whole-script 
    confusables (such as &quot;scope&quot; in Latin and Cyrillic), register those as well<span class="changedspan">, 
    if not automatically provided by the registry.</span></span><p class="reviewnote"><span>
    <span class="changedspan"><b>[program for whole-script confusables]</b></span></span></li>
  </ol>
  <h4><span>2.10.2 <a name="Recommendations_General">General Programmer Recommendations</a></span></h4>
  <ol type="A">
    <li><span>In all software that parses numbers, detect digits of mixed (or whole but unexpected) 
    scripts and alert the user.</span><p class="reviewnote"><span><b>[generalize to all text] </b>
    </span></li>
    <li><span>In checking equivalence of identifiers, preprocess both strings by applying NFKC and 
    case folding. An example of this methodology is StringPrep [<a href="#RFC3454">RFC3454</a>]. 
    Display all such identifiers to users in their post-processed form. That will, for example, 
    always map characters to lowercase, where characters are generally more distinctive. (Although 
    StringPrep itself is currently limited to Unicode 3.2, the same methodology can be applied by 
    implementations that need to support more modern versions of Unicode.)</span></li>
    <li><span>Disallow the use of <span class="changedspan">Non-Starter Characters</span> at the 
    start of an identifier, since those will often be clipped in display. <span class="changedspan">
    See </span></span><span class="changedspan"><a href="#Identifier_Characters">Appendix C</a> for 
    a list of these characters.</span><p class="reviewnote"><span><b>[for programming language / 
    protocol developers ]</b></span></p>
    <p class="reviewnote"><b><span class="changedspan">[when using fonts, use less-spoofable fonts]</span></b></p>
    <p class="reviewnote"><span><b>[target following at font developers / rendering system 
    programmers]</b></span></li>
    <li><span>Assess the font support of the OS/platform according to draft UTR #32: <i>Assessing 
    Unicode Support (to be issued soon, as a draft)</i>. See also the W3C [<a href="#CharMod">CharMod</a>]. 
    If it is inadequate, work with the OS/platform vendor to address those problems, or implement 
    your own handling of problematic cases:</span><ol>
      <li><span>Verify that accents do not appear to apply to the wrong character.</span></li>
      <li><span>Follow <a href="http://www.unicode.org/notes/tn2/">UTN #2: <i>Rendering Combining 
      Marks</i></a> in providing layout of nonspacing marks that would otherwise collide. If this is 
      not done, use the &quot;Show Hidden&quot; option of Section
      <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.13 <i>Rendering Nonspacing 
      Marks</i></a> of [<a href="#Unicode">Unicode</a>] for the display of nonspacing marks.</span></li>
      <li><span>Follow the Unicode guidelines for displaying missing glyphs using a 
      rounded-rectangle, as described in Section
      <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.3 <i>Unknown and Missing 
      Characters</i></a> of [<a href="#Unicode">Unicode</a>].<span class="changedspan"> The 
      recommended glyphs according to scripts are shown in </span></span><span class="changedspan">
      <span style="background-color: #FFFF00">Appendix D. <a href="#Missing_Character_Glyphs">
      Missing Character Glyphs</a>.</span></span></li>
    </ol>
    </li>
  </ol>
  <h4><span><b>2.10.3 <a name="Recommendations_User_Agents">User Agent Recommendations</a></b></span></h4>
  <p class="reviewnote"><b>[make sure to define &quot;user agent&quot; broadly]</b></p>
  <p class="reviewnote"><b>[display characters with enough pixels: more pixels for South/SE Asian, 
  CJK. Examples in Visual Display (CJK at low resolution). Watch for clipping, vertical/horizontal]</b></p>
  <p><span class="changedspan">The following are recommendations for user agents in handling domain 
  names.</span></p>
  <ol type="A">
    <li><span>Follow the General Recommendations above.</span></li>
    <li><span class="changedspan">Display</span><ol>
      <li><span class="changedspan">Make it </span><span><span class="changedspan">easy for the user 
      to see the</span> the domain name in </span>nameprepped form<span> [<a href="#RFC3491">RFC3491</a>]. 
      That will, for example, always map characters to lowercase, where characters are generally 
      more distinctive.<span class="changedspan"> See <a href="#Case_Folded_Format">
      Case_Folded_Format</a> for more details.</span></span><p class="reviewnote"><span><b>[for 
      example, hover -- or just converting]. </b></span></li>
      <li><span>Always display the domain name w</span>ith <span>fonts that shows as many 
      distinctions as possible among the visually confusable characters. Use a size that makes it 
      easier to see the differences in characters. Disallow the use of font sizes that are so small 
      as to cause even more characters to be visually confusable.</span></li>
      <li><span class="changedspan"><span>Always display the domain name w</span></span><span class="changedSpan">ith 
      a visually highlighted &quot;core&quot; domain, to prevent syntax spoofs (see Section 2.5
      <a href="#Syntax_Spoofing">Syntax Spoofing</a>)</span></li>
    </ol>
    </li>
    <li><span><span class="changedspan">Preferences</span></span><ol>
      <li><span class="changedspan">In preferences, allow the user to select the </span><span>
      <span class="changedspan">desired Restriction Level. This should apply to</span> the
      <span class="changedspan">core</span> domain name as described in this document.
      <span class="changedspan">Anything above that level should cause an appropriate alert. Set the 
      default to Restriction Level 2. </span></span></li>
      <li><span class="changedspan">In preferences, allow the user to select among scripts that can 
      be used without alerting. The default could be based on the user&#39;s locale.</span></li>
    </ol>
    </li>
    <li><span class="changedspan">If the confusable dat<span>a is available ([<a href="#confusables">confusables</a>]):</span></span><ol>
      <li>R<span>aise the default level to Level 3<span class="changedspan">, and allow Latin with 
      any other script.</span></span></li>
      <li><span class="changedSpan">If the domain name has a whole-script confusable, verify that 
      both point to the same IP address. If not, alert the user. </span>
      <ul>
        <li><span>&quot;ѕсоре.com&quot; <i>(Cyrillic)</i> would cause an alert if &quot;scope.com&quot; <i>(Latin)</i> 
        had a different IP address.</span></li>
        <li>&quot;paypal.com&quot; <i>(with Cyrillic a)</i> would cause an alert because &quot;paypal.com&quot; <i>
        (Latin)</i> has a different IP address.</li>
      </ul>
      </li>
      <li><span class="changedspan">Otherwise, generate 0..N new domain names, whereby each 
      maximizes the number of characters of a given script using the confusable mappings. If any 
      have different IP addresses, alert the user.</span><ul>
        <li>&quot;<span>Ωmega</span>&quot; <i>(with Greek Omega)</i> would cause an alert if there was some 
        other combination registered, say with a Cyrillic &#39;e&#39;.</li>
        <li>Because the number of mixed-script inputs would be small, the average number of extra 
        DNS lookups would be very small.</li>
      </ul>
      </li>
    </ol>
    </li>
  </ol>
  <h4><span><b>2.10.4 <a name="Recommendations_Registries">Registry Recommendations</a></b></span></h4>
  <p class="reviewnote"><b><span class="removedspan">[Get text from Michel, Van: distinguish 
  registry owns the policy; from registrar accepts the names]</span></b></p>
  <p><span class="changedspan">The following are recommendations for registries in dealing with 
  domain names. </span>T<span>he term &quot;Registry&quot; is to be interpreted broadly. The .com operator can 
  impose restrictions on the 2nd level domain label, but if someone registers <i>foo.com</i>, then 
  it is up to them to decide what will be allowed at the 3rd level (for example, <i>bar.foo.com</i>). 
  So for that purpose, the owner of <i>foo.com</i> is treated as the &quot;registry&quot; for the 3rd level 
  (the <i>bar</i>). The term &quot;Registrant&quot; is used to refer to someone applying to a registry for a 
  domain name.</span></p>
  <ol type="A">
    <li><span>In the short term, use <span class="changedspan">Restriction Level </span>2 to 
    restrict new domain names.</span></li>
    <li><span class="changedspan">If the confusable dat<span>a is available ([<a href="#confusables">confusables</a>]):</span></span><ol>
      <li>R<span>aise the allowable Restriction Level to Level 5</span></li>
      <li>D<span>isallow registration of a new domain name that only differs by confusable 
      characters from one already registered<span class="changedspan"> by a different registrant</span>.
      </span><span class="changedSpan">Thus an existing registration of &quot;<span>ѕсоре.com</span>&quot; (<i>Cyrillic</i>) 
      would block a registration of &quot;scope.com&quot; (<i>Latin</i>) by a different registrant.</span></li>
    </ol>
    </li>
  </ol>
  <p><span class="changedspan">Thus a registry could allow registration of <span>
  <a href="http://caxap.ru/">http://caxap.ru/</a> in Latin (which is already registered), or the 
  Cyrillic equivalent, or both <font face="Lucida Sans Unicode">— but for both, <i>only</i> with the 
  same registrant!</font></span></span></p>
  <p><span><b>2.10.5 <a name="Recommendations_Registrars">Registar Recommendations</a></b></span></p>
  <p class="reviewnote"><b>[&nbsp;- When a user&#39;s name is (or would be) rejected by the registry because 
  of confusables, allow user to see why the rejection happened.]</b></p>
  <hr width="50%">
  <p class="reviewnote"><b>To Do:</b></p>
  <ol>
    <li>
    <p class="reviewnote"><span>Give more background as to why normalization fixes certain problems, 
    and which it does not fix. Describe how implementations of normalization can use small data set 
    limited to only supported characters. Describe the recommended use of normalization in 
    non-domain part of URL.</span></li>
    <li>
    <p class="reviewnote"><span>Describe BIDI spoofs. Use material from Michel&#39;s slides. Show how 
    reverse-bidi (visual order -&gt; storage order) can be used to detect bidi spoofs. That is: one can 
    apply bidi then reverse bidi: if the result does not match the original, then reject the string.</span></li>
    <li>
    <p class="reviewnote"><span>Explain that private use characters can cause security problems, and 
    recommend strongly against their use (not a problem for IDN, but for other identifiers it can 
    be).</span></li>
    <li>
    <p class="reviewnote"><span>Describe cases in complex languages (eg Indic) where the same visual 
    appearance may result from two different undering character sequences — <i>in the right context</i>.</span></li>
    <li>
    <p class="reviewnote"><span>Add information on spoofs that only work with contextual scripts, 
    such as Arabic.</span></li>
    <li>
    <p class="reviewnote"><span>Discuss security issues in Collation (sorting, searching, matching)</span></li>
    <li>
    <p class="reviewnote"><span>Describe how TrueType/OpenType fonts can be used in spoofing: fonts 
    are actually programs that can deform glyph shapes radically according to resolution, platform, 
    or language. For example $100.00 could appear as $200.00 when printed.</span></li>
    <li>
    <p class="reviewnote"><span>Discuss SSL and how root Certificate Authorities can be a problem, 
    but are also part of the solution; most customers would lose faith quickly in internet financial 
    transaction if SSL/https can be easily compromised</span></li>
    <li>
    <p class="reviewnote">Expand other applications of visual spoofing, aside from the example of 
    IDN. Internationalized Domain Names are actually in much better shape than many other areas, 
    since the problem will be much more severe in any area where text is not normalized. So focus on 
    those issues.</li>
  </ol>
  <h2><a name="Canonical_Represenation"></a>3. Non-Visual Security Issues</h2>
  <p>A common practice is to have a &#39;gatekeeper&#39; for a system. That gatekeeper checks incoming data 
  to ensure that it is safe, and passes only safe data through. Once in the system, the other 
  components assume that the data is safe. A problem arises when a component treats two pieces of 
  text as identical — typically by canonicalizing them to the same form — while the gatekeeper only 
  detected that one of them was unsafe.</p>
  <h3>3.1 <a name="UTF-8_Exploit">UTF-8 Exploit</a></h3>
  <p>There are three equivalent encoding forms for Unicode: UTF-8, UTF-16, and UTF-32. UTF-8 is 
  commonly used in XML and HTML; UTF-16 is the most common in program APIs; and UTF-32 is the best 
  for representing single characters. While these forms are all equivalent in terms of the ability 
  to express Unicode, the original usage of UTF-8 was open to a canonicalization exploit.</p>
  <p>Up to <a href="http://www.unicode.org/uni2book/u2.html"><i>The Unicode Standard, Version 3.0</i></a> 
  the <i>generation</i> of &quot;non-shortest form&quot; UTF-8 was forbidden, as was the <i>interpretation</i> 
  of illegal sequences, but not the interpretation of what was called the &quot;non-shortest form&quot;. Where 
  software does interpret the non-shortest forms, security issues can arise. For example: </p>
  <ul>
    <li>Process <i>A</i> performs security checks, but does not check for non-shortest forms. </li>
    <li>Process <i>B</i> accepts the byte sequence from process <i>A</i>, and transforms it into 
    UTF-16 while interpreting non-shortest forms. </li>
    <li>The UTF-16 text may then contain characters that should have been filtered out by process <i>
    A</i>.</li>
  </ul>
  <p>For example, the backslash character &quot;\&quot; can often be a dangerous character to let through a 
  gatekeeper, since it can be used to access different directories. Thus a gatekeeper might 
  specifically prevent it from getting through. The backslash is represented in UTF-8 as the byte 
  sequence &lt;5C&gt;. However, as a non-shortest form, backslash could also be represented as the byte 
  sequence&lt;C1 9C&gt;. When a gatekeeper does not catch that, but a component converts non-shortest 
  forms, it can allow a real security breach. For more information, see <span class="changedSpan">[<a href="#Related_Material">Related 
  Material</a>]</span>.</p>
  <p>To address this issue, the Unicode Technical Committee modified the definition of UTF-8 in
  <a href="http://www.unicode.org/reports/tr27/">Unicode 3.1</a> to forbid conformant 
  implementations from interpreting non-shortest forms for
  <a href="http://www.unicode.org/glossary/#BMP_character">BMP characters</a>, and clarified some of 
  the conformance clauses.</p>
  <p class="reviewnote"><b>To Do:</b></p>
  <p class="reviewnote">Add information about other possible exploits in this area:</p>
  <ol>
    <li>
    <p class="reviewnote">Unicode Normalization</li>
    <li>
    <p class="reviewnote">Case mapping</li>
    <li>
    <p class="reviewnote">Buffer overflows with all of the above, and when converting encoding forms</li>
    <li>
    <p class="reviewnote">Discuss Unicode properties. Eg more characters have numeric properties 
    than developers might expect.</li>
    <li>
    <p class="reviewnote">Discuss use of Regular Expressions in validating data — ensuring that the 
    Regular Expression Engine follows the Unicode Guidelines, but also that use of regular 
    expressions makes use of properties rather than fixed lists of characters.</li>
    <li>
    <p class="reviewnote"><span>Explain that private use characters can cause security problems, and 
    recommend strongly against their use.</span></li>
    <li>
    <p class="reviewnote"><span>Discuss security issues in Collation (sorting, searching, matching)</span></li>
  </ol>
  <h3>3.2 <a name="Non_Visual_Recommendations">Recommendations</a></h3>
  <ol>
    <li>Ensure that all implementations of UTF-8 used in a system are conformant to the latest 
    version of Unicode.</li>
  </ol>
  <h2>Appendix A<span>. <a name="Data_Files">Data Files</a></span></h2>
  <p><span>There are three data files currently associated with this document.</span></p>
  <p class="reviewnote"><span><i>Note: we are just starting the project of collecting data for the 
  second two files, and examining the feasibility of different approaches, so we have just begun to 
  gather data.</i></span></p>
  <table cellspacing="0" cellpadding="4" border="0" class="noborder" style="border-collapse: collapse">
    <tr>
      <td class="noborder" valign="top" width="1" nowrap="nowrap"><span>[<a name="idn-chars">idn-chars</a>]</span></td>
      <td class="noborder" valign="top"><span><b>IDN Characters: </b>Categorizes all the possible 
      IDN chars<span class="changedspan">, under the current definition of IDN</span></span><span class="changedspan">. 
      The form</span><span><span class="changedspan">at of both files is described in the html file.</span><b><br>
      </b><a href="idn-chars.html">idn-chars.html</a><b><br>
      </b><span class="changedspan"><a href="idn-chars.txt">idn-chars.txt</a></span></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="confusables">confusables</a>]</span></td>
      <td class="noborder" valign="top"><b>Visually Confusable Characters:</b> Provides a mapping 
      for visually confusables. <span>The format and usage of the file are described in the file 
      header.</span><b><br>
      </b><a href="confusables.txt"><span>confusables.txt</span></a></td>
    </tr>
  </table>
  <p>&nbsp;</p>
  <hr width="50%">
  <h2><span class="changedSpan">Appendix B. <a name="Related_Material">Related Material</a></span></h2>
  <p><span class="changedspan">The following points to background information that may be useful.</span></p>
  <p><b><span class="changedspan">[Put in references section]</span></b></p>
  <h3><span class="changedSpan">Canonical Representation</span></h3>
  <ul>
    <li><span class="changedSpan">
    <a href="http://www.microsoft.com/technet/security/bulletin/MS00-078.mspx">Microsoft Security 
    Bulletin (MS00-078): Patch Available for &#39;Web Server Folder Traversal&#39; Vulnerability</a></span></li>
    <li><span class="changedSpan">
    <a href="http://www.ins.com/downloads/whitepapers/ins_white_paper_ms_iis_unicode_exploit_0801.pdf">
    INS: Microsoft IIS Unicode Exploit</a></span></li>
    <li><a href="http://www.nextgenss.com/papers/unicodebo.pdf">Creating Arbitrary Shellcode In 
    Unicode Expanded Strings</a></li>
    <li><a href="http://www.phrack.org/show.php?p=61&a=11">Building Unicode-Proof Shellcodes</a>
    </li>
  </ul>
  <h3><span class="changedSpan">Visual Spoofing</span></h3>
  <ul>
    <li><span class="changedSpan">
    <a href="http://www.cs.technion.ac.il/~gabr/papers/homograph_full.pdf">The Homograph Attack</a></span></li>
    <li><span class="changedSpan">
    <a href="http://news.zdnet.co.uk/internet/security/0,39020375,2080344,00.htm">PayPal alert! 
    Beware the &#39;PaypaI&#39; scam</a></span></li>
    <li><span class="changedSpan"><a href="http://www.icann.org/topics/news022305.html">gTLD 
    Registry Constutuency: Potential of IDN for malicious abuse</a></span></li>
    <li><span class="changedSpan"><a href="http://www.icann.org/topics/idn.html">ICANN | 
    Internationalized Domain Names</a></span></li>
    <li><span class="changedSpan">
    <a href="http://www.ietf.org/IESG/STATEMENTS/IDNstatement.txt" target="_blank">IESG statement of 
    11 February 2003</a></span></li>
    <li><span class="changedSpan"><a href="http://forum.icann.org/lists/idn-homograph/">ICANN Email 
    Archives [idn-homograph]</a></span></li>
    <li><span class="changedSpan">
    <a href="http://www.ietf.org/internet-drafts/draft-klensin-reg-guidelines-06.txt">Suggested 
    Practices for Registration of Internationalized Domain Names (IDN)</a></span></li>
    <li><span class="changedSpan"><a href="http://secunia.com/multiple_browsers_idn_spoofing_test/">
    Multiple Browsers IDN Spoofing Test</a></span></li>
  </ul>
  <h2 class="old_changed"><span class="changedspan">Appendix C. <a name="Identifier_Characters">
  Identifier Characters</a></span></h2>
  <p class="reviewnote"><span class="changedspan"><span style="background-color: #FFFF00"><b>
  [summarize programming languages]</b></span></span></p>
  <p class="reviewnote"><span class="changedspan"><span style="background-color: #FFFF00"><b>
  [introduce differences]</b></span></span></p>
  <p class="reviewnote"><span class="changedspan">
  <span style="font-weight: 700; background-color: #FFFF00">[recast as a profile of #31]</span></span></p>
  <p class="old_changed"><span class="changedspan"><span style="background-color: #FFFF00">The 
  characters recommended for general use as identifiers for the purpose of this document include 
  those character </span><span>having the </span>XID_Continue property as defined in the Unicode 
  Character Database (see [<a href="#DCore">DCore</a>]), plus the characters listed in Additional 
  Word Characters below, which are required for expressing words in some languages.</span></p>
  <p class="old_changed"><span class="changedspan">The list of allowable characters may be reduced 
  or expanded according to the requirements of the specific domain. For example, programming 
  language identifiers typically add some characters like &#39;$&#39;, and remove others like &#39;-&#39; (because 
  of the use as <i>minus</i>), while IDNA removes &#39;_&#39; (among others). For more information, see <i>
  UAX #31, Identifier and Pattern Syntax</i> [<a href="#UAX31">UAX31</a>].</span></p>
  <p class="reviewnote"><b><span class="changedspan">[Remove Default Ignorables]</span></b></p>
  <p class="reviewnote"><b><span class="changedspan">Recommend converting 0027 to 2019 on input.</span></b></p>
  <p class="reviewnote"><span class="changedspan"><b>[Add examples of rationales. Emphasize out that 
  environment may add / expand]</b></span></p>
  <h3><span class="changedspan"><span style="background-color: #FFFF00">C.1. Additional Word 
  Characters</span></span></h3>
  <p><span class="changedspan">002D&nbsp; ; word-chars # Pd (-)&nbsp; HYPHEN-MINUS<br>
  00B7&nbsp; ; word-chars # Po (·)&nbsp; MIDDLE DOT<br>
  02B9&nbsp; ; word-chars # Lm (ʹ)&nbsp; MODIFIER LETTER PRIME<br>
  02BA&nbsp; ; word-chars # Lm (ʺ)&nbsp; MODIFIER LETTER DOUBLE PRIME<br>
  04C0&nbsp; ; word-chars # L&amp; (Ӏ)&nbsp; CYRILLIC LETTER PALOCHKA<br>
  055A&nbsp; ; word-chars # Po (՚)&nbsp; ARMENIAN APOSTROPHE<br>
  058A&nbsp; ; word-chars # Pd (֊)&nbsp; ARMENIAN HYPHEN<br>
  05F3&nbsp; ; word-chars # Po (׳)&nbsp; HEBREW PUNCTUATION GERESH<br>
  05F4&nbsp; ; word-chars # Po (״)&nbsp; HEBREW PUNCTUATION GERSHAYIM<br>
  0F85&nbsp; ; word-chars # .. (྅) TIBETAN MARK PALUTA<br>
  2010&nbsp; ; word-chars # Pd (‐)&nbsp; HYPHEN<br>
  2019&nbsp; ; word-chars # Pf (’)&nbsp; RIGHT SINGLE QUOTATION MARK<br>
  30A0&nbsp; ; word-chars # Pd (゠)&nbsp; KATAKANA-HIRAGANA DOUBLE HYPHEN<br>
  30FB&nbsp; ; word-chars # .. (・) KATAKANA MIDDLE DOT</span></p>
  <p><span class="changedspan">2027&nbsp; ; word-chars # Po (‧)&nbsp; HYPHENATION POINT<br>
  3003&nbsp; ; word-chars # .. (〃) DITTO MARK</span></p>
  <h3><span class="changedspan"><span style="background-color: #FFFF00">C.2. Non-Starter Characters</span></span></h3>
  <p><span class="changedspan">These are all characters of General Category Mn or Me (Nonspacing or 
  Enclosing Mark).</span></p>
  <h3><span class="changedspan"><span style="background-color: #FFFF00">C.3. Special-Purpose 
  Characters</span></span></h3>
  <p class="old_changed"><span class="changedspan">The Special-Purpose Characters are used in the 
  definition of Restriction Levels. They include all characters with the General Category Nl 
  (Letter-Number), plus the following list:</span></p>
  <p><span class="changedspan">0138&nbsp; ; Ll # (ĸ)&nbsp; LATIN SMALL LETTER KRA<br>
  0180&nbsp; ; Ll # (ƀ)&nbsp; LATIN SMALL LETTER B WITH STROKE<br>
  018D&nbsp; ; Ll # (ƍ)&nbsp; LATIN SMALL LETTER TURNED DELTA<br>
  019B&nbsp; ; Ll # (ƛ)&nbsp; LATIN SMALL LETTER LAMBDA WITH STROKE<br>
  01AA&nbsp; ; Ll # (ƪ)&nbsp; LATIN LETTER REVERSED ESH LOOP<br>
  01AB&nbsp; ; Ll # (ƫ)&nbsp; LATIN SMALL LETTER T WITH PALATAL HOOK<br>
  01BA&nbsp; ; Ll # (ƺ)&nbsp; LATIN SMALL LETTER EZH WITH TAIL<br>
  01BE&nbsp; ; Ll # (ƾ)&nbsp; LATIN LETTER INVERTED GLOTTAL STOP WITH STROKE<br>
  0250&nbsp; ; Ll # (ɐ)&nbsp; LATIN SMALL LETTER TURNED A<br>
  0251&nbsp; ; Ll # (ɑ)&nbsp; LATIN SMALL LETTER ALPHA<br>
  0252&nbsp; ; Ll # (ɒ)&nbsp; LATIN SMALL LETTER TURNED ALPHA<br>
  0255&nbsp; ; Ll # (ɕ)&nbsp; LATIN SMALL LETTER C WITH CURL<br>
  0258&nbsp; ; Ll # (ɘ)&nbsp; LATIN SMALL LETTER REVERSED E<br>
  025A&nbsp; ; Ll # (ɚ)&nbsp; LATIN SMALL LETTER SCHWA WITH HOOK<br>
  025C&nbsp; ; Ll # (ɜ)&nbsp; LATIN SMALL LETTER REVERSED OPEN E<br>
  025D&nbsp; ; Ll # (ɝ)&nbsp; LATIN SMALL LETTER REVERSED OPEN E WITH HOOK<br>
  025E&nbsp; ; Ll # (ɞ)&nbsp; LATIN SMALL LETTER CLOSED REVERSED OPEN E<br>
  025F&nbsp; ; Ll # (ɟ)&nbsp; LATIN SMALL LETTER DOTLESS J WITH STROKE<br>
  0261&nbsp; ; Ll # (ɡ)&nbsp; LATIN SMALL LETTER SCRIPT G<br>
  0262&nbsp; ; Ll # (ɢ)&nbsp; LATIN LETTER SMALL CAPITAL G<br>
  0264&nbsp; ; Ll # (ɤ)&nbsp; LATIN SMALL LETTER RAMS HORN<br>
  0265&nbsp; ; Ll # (ɥ)&nbsp; LATIN SMALL LETTER TURNED H<br>
  0266&nbsp; ; Ll # (ɦ)&nbsp; LATIN SMALL LETTER H WITH HOOK<br>
  0267&nbsp; ; Ll # (ɧ)&nbsp; LATIN SMALL LETTER HENG WITH HOOK<br>
  026A&nbsp; ; Ll # (ɪ)&nbsp; LATIN LETTER SMALL CAPITAL I<br>
  026B&nbsp; ; Ll # (ɫ)&nbsp; LATIN SMALL LETTER L WITH MIDDLE TILDE<br>
  026C&nbsp; ; Ll # (ɬ)&nbsp; LATIN SMALL LETTER L WITH BELT<br>
  026D&nbsp; ; Ll # (ɭ)&nbsp; LATIN SMALL LETTER L WITH RETROFLEX HOOK<br>
  026E&nbsp; ; Ll # (ɮ)&nbsp; LATIN SMALL LETTER LEZH<br>
  0270&nbsp; ; Ll # (ɰ)&nbsp; LATIN SMALL LETTER TURNED M WITH LONG LEG<br>
  0271&nbsp; ; Ll # (ɱ)&nbsp; LATIN SMALL LETTER M WITH HOOK<br>
  0273&nbsp; ; Ll # (ɳ)&nbsp; LATIN SMALL LETTER N WITH RETROFLEX HOOK<br>
  0274&nbsp; ; Ll # (ɴ)&nbsp; LATIN LETTER SMALL CAPITAL N<br>
  0276&nbsp; ; Ll # (ɶ)&nbsp; LATIN LETTER SMALL CAPITAL OE<br>
  0277&nbsp; ; Ll # (ɷ)&nbsp; LATIN SMALL LETTER CLOSED OMEGA<br>
  0278&nbsp; ; Ll # (ɸ)&nbsp; LATIN SMALL LETTER PHI<br>
  0279&nbsp; ; Ll # (ɹ)&nbsp; LATIN SMALL LETTER TURNED R<br>
  027A&nbsp; ; Ll # (ɺ)&nbsp; LATIN SMALL LETTER TURNED R WITH LONG LEG<br>
  027B&nbsp; ; Ll # (ɻ)&nbsp; LATIN SMALL LETTER TURNED R WITH HOOK<br>
  027C&nbsp; ; Ll # (ɼ)&nbsp; LATIN SMALL LETTER R WITH LONG LEG<br>
  027D&nbsp; ; Ll # (ɽ)&nbsp; LATIN SMALL LETTER R WITH TAIL<br>
  027E&nbsp; ; Ll # (ɾ)&nbsp; LATIN SMALL LETTER R WITH FISHHOOK<br>
  027F&nbsp; ; Ll # (ɿ)&nbsp; LATIN SMALL LETTER REVERSED R WITH FISHHOOK<br>
  0281&nbsp; ; Ll # (ʁ)&nbsp; LATIN LETTER SMALL CAPITAL INVERTED R<br>
  0282&nbsp; ; Ll # (ʂ)&nbsp; LATIN SMALL LETTER S WITH HOOK<br>
  0284&nbsp; ; Ll # (ʄ)&nbsp; LATIN SMALL LETTER DOTLESS J WITH STROKE AND HOOK<br>
  0285&nbsp; ; Ll # (ʅ)&nbsp; LATIN SMALL LETTER SQUAT REVERSED ESH<br>
  0286&nbsp; ; Ll # (ʆ)&nbsp; LATIN SMALL LETTER ESH WITH CURL<br>
  0287&nbsp; ; Ll # (ʇ)&nbsp; LATIN SMALL LETTER TURNED T<br>
  0289&nbsp; ; Ll # (ʉ)&nbsp; LATIN SMALL LETTER U BAR<br>
  028C&nbsp; ; Ll # (ʌ)&nbsp; LATIN SMALL LETTER TURNED V<br>
  028D&nbsp; ; Ll # (ʍ)&nbsp; LATIN SMALL LETTER TURNED W<br>
  028E&nbsp; ; Ll # (ʎ)&nbsp; LATIN SMALL LETTER TURNED Y<br>
  028F&nbsp; ; Ll # (ʏ)&nbsp; LATIN LETTER SMALL CAPITAL Y<br>
  0290&nbsp; ; Ll # (ʐ)&nbsp; LATIN SMALL LETTER Z WITH RETROFLEX HOOK<br>
  0291&nbsp; ; Ll # (ʑ)&nbsp; LATIN SMALL LETTER Z WITH CURL<br>
  0293&nbsp; ; Ll # (ʓ)&nbsp; LATIN SMALL LETTER EZH WITH CURL<br>
  0295&nbsp; ; Ll # (ʕ)&nbsp; LATIN LETTER PHARYNGEAL VOICED FRICATIVE<br>
  0296&nbsp; ; Ll # (ʖ)&nbsp; LATIN LETTER INVERTED GLOTTAL STOP<br>
  0297&nbsp; ; Ll # (ʗ)&nbsp; LATIN LETTER STRETCHED C<br>
  0298&nbsp; ; Ll # (ʘ)&nbsp; LATIN LETTER BILABIAL CLICK<br>
  0299&nbsp; ; Ll # (ʙ)&nbsp; LATIN LETTER SMALL CAPITAL B<br>
  029A&nbsp; ; Ll # (ʚ)&nbsp; LATIN SMALL LETTER CLOSED OPEN E<br>
  029B&nbsp; ; Ll # (ʛ)&nbsp; LATIN LETTER SMALL CAPITAL G WITH HOOK<br>
  029C&nbsp; ; Ll # (ʜ)&nbsp; LATIN LETTER SMALL CAPITAL H<br>
  029D&nbsp; ; Ll # (ʝ)&nbsp; LATIN SMALL LETTER J WITH CROSSED-TAIL<br>
  029E&nbsp; ; Ll # (ʞ)&nbsp; LATIN SMALL LETTER TURNED K<br>
  029F&nbsp; ; Ll # (ʟ)&nbsp; LATIN LETTER SMALL CAPITAL L<br>
  02A0&nbsp; ; Ll # (ʠ)&nbsp; LATIN SMALL LETTER Q WITH HOOK<br>
  02A1&nbsp; ; Ll # (ʡ)&nbsp; LATIN LETTER GLOTTAL STOP WITH STROKE<br>
  02A2&nbsp; ; Ll # (ʢ)&nbsp; LATIN LETTER REVERSED GLOTTAL STOP WITH STROKE<br>
  02A3&nbsp; ; Ll # (ʣ)&nbsp; LATIN SMALL LETTER DZ DIGRAPH<br>
  02A4&nbsp; ; Ll # (ʤ)&nbsp; LATIN SMALL LETTER DEZH DIGRAPH<br>
  02A5&nbsp; ; Ll # (ʥ)&nbsp; LATIN SMALL LETTER DZ DIGRAPH WITH CURL<br>
  02A6&nbsp; ; Ll # (ʦ)&nbsp; LATIN SMALL LETTER TS DIGRAPH<br>
  02A7&nbsp; ; Ll # (ʧ)&nbsp; LATIN SMALL LETTER TESH DIGRAPH<br>
  02A8&nbsp; ; Ll # (ʨ)&nbsp; LATIN SMALL LETTER TC DIGRAPH WITH CURL<br>
  02A9&nbsp; ; Ll # (ʩ)&nbsp; LATIN SMALL LETTER FENG DIGRAPH<br>
  02AA&nbsp; ; Ll # (ʪ)&nbsp; LATIN SMALL LETTER LS DIGRAPH<br>
  02AB&nbsp; ; Ll # (ʫ)&nbsp; LATIN SMALL LETTER LZ DIGRAPH<br>
  02AC&nbsp; ; Ll # (ʬ)&nbsp; LATIN LETTER BILABIAL PERCUSSIVE<br>
  02AD&nbsp; ; Ll # (ʭ)&nbsp; LATIN LETTER BIDENTAL PERCUSSIVE<br>
  03D7&nbsp; ; Ll # (ϗ)&nbsp; GREEK KAI SYMBOL<br>
  03F3&nbsp; ; Ll # (ϳ)&nbsp; GREEK LETTER YOT<br>
  <br>
  # Total code points: 84<br>
  <br>
  0559&nbsp; ; Lm # (ՙ)&nbsp; ARMENIAN MODIFIER LETTER LEFT HALF RING<br>
  <br>
  # Total code points: 1<br>
  <br>
  01BB&nbsp; ; Lo # (ƻ)&nbsp; LATIN LETTER TWO WITH STROKE<br>
  01C0&nbsp; ; Lo # (ǀ)&nbsp; LATIN LETTER DENTAL CLICK<br>
  01C1&nbsp; ; Lo # (ǁ)&nbsp; LATIN LETTER LATERAL CLICK<br>
  01C2&nbsp; ; Lo # (ǂ)&nbsp; LATIN LETTER ALVEOLAR CLICK<br>
  01C3&nbsp; ; Lo # (ǃ)&nbsp; LATIN LETTER RETROFLEX CLICK<br>
  <br>
  # Total code points: 5<br>
  <br>
  0483&nbsp; ; Mn # (҃)&nbsp; COMBINING CYRILLIC TITLO<br>
  0484&nbsp; ; Mn # (҄)&nbsp; COMBINING CYRILLIC PALATALIZATION<br>
  0485&nbsp; ; Mn # (҅)&nbsp; COMBINING CYRILLIC DASIA PNEUMATA<br>
  0486&nbsp; ; Mn # (҆)&nbsp; COMBINING CYRILLIC PSILI PNEUMATA<br>
&nbsp;</span></p>
  <p class="reviewnote">These lists are still draft! Once finalized, they should become regular 
  properties.</p>
  <p class="reviewnote">We should extend the Special Purpose Characters to include problematic 
  characters even outside XID_Continue. This would be so that if an implementation extends the set 
  of Identifier Characters, that it can distinguish between characters like<span title="U+2665 BLACK HEART SUIT">
  <i>heart</i> (♥) which don&#39;t cause a problem for spoofing and those like <i>division slash</i> (</span><span title="U+2215 DIVISION SLASH">∕</span><span title="U+2665 BLACK HEART SUIT">) 
  which do.</span></p>
  <h2 class="old_changed"><span class="changedspan">Appendix D. <a name="Missing_Character_Glyphs">
  Missing Character Glyphs</a></span></h2>
  <p class="old_changed"><b>[This will be removed once it is in UAX #xx, Script Names.]</b></p>
  <table cellSpacing="0" cellPadding="2" border="1">
    <tr>
      <th class="script" width="33%"><span class="changedspan">
      <img src="images/latin.gif" alt="X" width="24" height="24"> Latin</span></th>
      <th class="script" width="33%"><span class="changedspan">
      <img src="images/tibetan.gif" alt="X" width="24" height="24"> Tibetan</span></th>
      <th class="script" width="33%"><span class="changedspan">
      <img src="images/hanunoo.gif" alt="X" width="24" height="24"> Hanunoo</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/greek.gif" alt="X" width="24" height="24"> Greek</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/myanmar.gif" alt="X" width="24" height="24"> Myanmar</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/buhid.gif" alt="X" width="24" height="24"> Buhid</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/cyrillic.gif" alt="X" width="24" height="24"> Cyrillic</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/georgian.gif" alt="X" width="24" height="24"> Georgian</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/tagbanwa.gif" alt="X" width="24" height="24"> Tagbanwa</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/armenian.gif" alt="X" width="24" height="24"> Armenian</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/hangulsyllables.gif" alt="X" width="24" height="24"> Hangul</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/limbu.gif" alt="X" width="24" height="24"> Limbu</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/hebrew.gif" alt="X" width="24" height="24"> Hebrew</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/ethiopic.gif" alt="X" width="24" height="24"> Ethiopic</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/taile.gif" alt="X" width="24" height="24"> Tai Le</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/arabic.gif" alt="X" width="24" height="24"> Arabic</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/cherokee.gif" alt="X" width="24" height="24"> Cherokee</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/linearbsyllabary.gif" alt="X" width="24" height="24"> Linear B</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/syriac.gif" alt="X" width="24" height="24"> Syriac</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/canadiansyllabics.gif" alt="X" width="24" height="24"> Canadian Aboriginal</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/ugaritic.gif" alt="X" width="24" height="24"> Ugaritic</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/thaana.gif" alt="X" width="24" height="24"> Thaana</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/ogham.gif" alt="X" width="24" height="24"> Ogham</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/shavian.gif" alt="X" width="24" height="24"> Shavian</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/devanagari.gif" alt="X" width="24" height="24"> Devanagari</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/runic.gif" alt="X" width="24" height="24"> Runic</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/osmanya.gif" alt="X" width="24" height="24"> Osmanya</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/bengali.gif" alt="X" width="24" height="24"> Bengali</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/khmer.gif" alt="X" width="24" height="24"> Khmer</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/cypriot.gif" alt="X" width="24" height="24"> Cypriot</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/gurmukhi.gif" alt="X" width="24" height="24"> Gurmukhi</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/mongolian.gif" alt="X" width="24" height="24"> Mongolian</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/braillesymbols.gif" alt="X" width="24" height="24"> Braille</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/gujarati.gif" alt="X" width="24" height="24"> Gujarati</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/hiragana.gif" alt="X" width="24" height="24"> Hiragana</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/buginese.gif" alt="X" width="24" height="24"> Buginese</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/oriya.gif" alt="X" width="24" height="24"> Oriya</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/katakana.gif" alt="X" width="24" height="24"> Katakana</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/coptic.gif" alt="X" width="24" height="24"> Coptic</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/tamil.gif" alt="X" width="24" height="24"> Tamil</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/bopomofo.gif" alt="X" width="24" height="24"> Bopomofo</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/newtailu.gif" alt="X" width="24" height="24"> New Tai Lue</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/telugu.gif" alt="X" width="24" height="24"> Telugu</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/kangxiradicals.gif" alt="X" width="24" height="24"> Han</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/glagolitic.gif" alt="X" width="24" height="24"> Glagolitic</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/kannada.gif" alt="X" width="24" height="24"> Kannada</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/yi.gif" alt="X" width="24" height="24"> Yi</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/tifinagh.gif" alt="X" width="24" height="24"> Tifinagh</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/malayalam.gif" alt="X" width="24" height="24"> Malayalam</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/olditalic.gif" alt="X" width="24" height="24"> Old Italic</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/silotinagri.gif" alt="X" width="24" height="24"> Syloti Nagri</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/sinhala.gif" alt="X" width="24" height="24"> Sinhala</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/gothic.gif" alt="X" width="24" height="24"> Gothic</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/oldpersiancuneiform.gif" alt="X" width="24" height="24"> Old Persian</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/thai.gif" alt="X" width="24" height="24"> Thai</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/deseret.gif" alt="X" width="24" height="24"> Deseret</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/kharoshthi.gif" alt="X" width="24" height="24"> Kharoshthi</span></th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/lao.gif" alt="X" width="24" height="24"> Lao</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/tagalog.gif" alt="X" width="24" height="24"> Tagalog</span></th>
      <th class="script">&nbsp;</th>
    </tr>
    <tr>
      <th class="script" colspan="3" bgcolor="#EEEEFF">&nbsp;</th>
    </tr>
    <tr>
      <th class="script"><span class="changedspan">
      <img src="images/common.gif" alt="X" width="24" height="24"> Common</span></th>
      <th class="script"><span class="changedspan">
      <img src="images/combiningdiacritics.gif" alt="X" width="24" height="24"> Inherited</span></th>
      <th class="script">&nbsp;</th>
    </tr>
  </table>
  <h2 class="old_changed">&nbsp;</h2>
  <h2><b>Appendix E. <a name="Confusable_Detection">Confusable Detection</a></b></h2>
  <p class="reviewnote"><b>[discuss here how to use the confusable mapping.</b></p>
  <p class="reviewnote"><b>Issues:</b></p>
  <p class="reviewnote"><b>* Splitting confusables / inscript/crossscript, case</b></p>
  <p class="reviewnote"><b>* clarify transitive issues, required for avoiding combinatoric 
  explosion. Clarify that confusables are partial solution.<br>
  * skeleton is much easier to handle -- explain why. Warn people that it is not the last word.<br>
  * break out cases that are gray cases of confusables. Registries may want to exclude these.<br>
  * Give example of Hebrew - traditional fonts very confusable - modern better.]</b><br>
&nbsp;</p>
  <h2 class="old_changed"><a name="Acknowledgements">Acknowledgements</a></h2>
  <p class="old_changed">Steven Loomis and other people on the ICU team were very helpful in 
  developing the original proposal for this technical report. Thanks also to the following people 
  for their feedback or contributions to this document <span>or earlier versions of it</span>: 
  Martin Dürst, Paul Hoffman, <span class="changedspan">Peter Karlsson</span><span><span class="changedspan">, 
  Gervase Markham, </span>Eric Muller, and especially Erik van der Poel, </span>
  <span class="changedspan">Marcos Sanz</span><span> and Michel Suignard. This document also draws 
  on examples or ideas suggested in email discussions from Alexander Savenkov, Erik van der Poel, 
  and others.</span></p>
  <h2><a name="References">References</a></h2>
  <table cellspacing="0" cellpadding="4" border="0" class="noborder" style="border-collapse: collapse">
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="CharMod">CharMod</a>]</span></td>
      <td class="noborder" valign="top"><span>Character Model for the World Wide Web 1.0: 
      Fundamentals<br>
      <a href="http://www.w3.org/TR/charmod/">http://www.w3.org/TR/charmod/</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="Charts">Charts</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedspan"><span>Unicode Charts (with Last 
      Resort Glyphs)<br>
      </span><a href="http://www.unicode.org/charts/lastresort.html">
      http://www.unicode.org/charts/lastresort.html</a> </span>
      <p><span class="changedspan">See also:<br>
      <a href="http://developer.apple.com/fonts/LastResortFont/">
      http://developer.apple.com/fonts/LastResortFont/</a> <br>
      <a href="http://developer.apple.com/fonts/LastResortFont/LastResortTable.html">
      http://developer.apple.com/fonts/LastResortFont/LastResortTable.html</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="DCore">DCore</a>]</td>
      <td class="noborder" valign="top">Derived Core Properties<br>
      <a href="http://unicode.org/Public/UNIDATA/DerivedCoreProperties.txt">
      http://unicode.org/Public/UNIDATA/DerivedCoreProperties.txt</a>&nbsp; </td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="Display">Display</a>]</span></td>
      <td class="noborder" valign="top"><span>Display Problems?<br>
      <a href="http://www.unicode.org/help/display_problems.html">
      http://www.unicode.org/help/display_problems.html</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1" nowrap="nowrap"><span class="changedSpan">
      <span style="background-color: #FFFF00">[<a name="ICANN">ICANN</a>]</span></span></td>
      <td class="noborder" valign="top"><span class="changedspan">Guidelines for the Implementation 
      of Internationalized Domain Names <br>
      <span><a href="http://www.icann.org/general/idn-guidelines-20jun03.htm">
      http://www.icann.org/general/idn-guidelines-20jun03.htm</a></span></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1" nowrap="nowrap"><span class="changedspan">
      <span style="background-color: #FFFF00">[<a name="DNS-Case">DNS-Case</a>]</span></span></td>
      <td class="noborder" valign="top"><span class="changedspan">Donald E. Eastlake 3rd. &quot;Domain 
      Name System (DNS) Case Insensitivity Clarification&quot;. Internet Draft, January 2005<br>
      <a href="http://www.ietf.org/internet-drafts/draft-ietf-dnsext-insensitive-05.txt">
      http://www.ietf.org/internet-drafts/draft-ietf-dnsext-insensitive-05.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1" nowrap="nowrap"><span class="changedSpan"><span>[<a name="IDN-Demo">IDN-Demo</a>]</span></span></td>
      <td class="noborder" valign="top"><span class="changedSpan"><span>ICU (International 
      Components for Unicode) IDN Demo<br>
      <a href="http://ibm.com/software/globalization/icu/demo/domain/">
      http://ibm.com/software/globalization/icu/demo/domain/</a></span></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Feedback">Feedback</a>]</td>
      <td class="noborder" valign="top">Reporting Errors and Requesting Information Online<i><br>
      </i><a href="http://www.unicode.org/reporting.html">http://www.unicode.org/reporting.html</a></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Reports">Reports</a>]</td>
      <td class="noborder" valign="top">Unicode Technical Reports<br>
      <a href="http://www.unicode.org/reports/">http://www.unicode.org/reports/<br>
      </a><i>For information on the status and development process for technical reports, and for a 
      list of technical reports.</i></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedspan">[<a name="RFC1034">RFC1034</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedspan">P. Mockapetris. &quot;DOMAIN NAMES - 
      CONCEPTS AND FACILITIES&quot;, RFC 1034, November 1987.<br>
      <a href="http://ietf.org/rfc/rfc1034.txt">http://ietf.org/rfc/rfc1034.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedspan">[<a name="RFC1035">RFC1035</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedspan">P. Mockapetris. &quot;DOMAIN NAMES - 
      IMPLEMENTATION AND SPECIFICATION&quot;, RFC 1034, November 1987.<br>
      <a href="http://ietf.org/rfc/rfc1035.txt">http://ietf.org/rfc/rfc1035.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedspan">[<a name="RFC1535">RFC1535</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedspan">E. Gavron. &quot;A Security Problem and 
      Proposed Correction With Widely Deployed DNS Software&quot;, RFC 1535, October 1993<br>
      <a href="http://ietf.org/rfc/rfc1535.txt">http://ietf.org/rfc/rfc1535.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="RFC3454">RFC3454</a>]</span></td>
      <td class="noborder" valign="top"><span>P. Hoffman, M. Blanchet. &quot;Preparation of 
      Internationalized Strings (&quot;stringprep&quot;)&quot;, RFC 3454, December 2002.<br>
      <a href="http://ietf.org/rfc/rfc3454.txt">http://ietf.org/rfc/rfc3454.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3490">RFC3490</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Faltstrom, P., Hoffman, P. and A. 
      Costello, &quot;Internationalizing Domain Names in Applications (IDNA)&quot;, RFC 3490, March 2003.<br>
      <a href="http://ietf.org/rfc/rfc3490.txt">http://ietf.org/rfc/rfc3490.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3491">RFC3491</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Hoffman, P. and M. Blanchet, &quot;Nameprep: 
      A Stringprep Profile for Internationalized Domain Names (IDN)&quot;, RFC 3491, March 2003.<br>
      <a href="http://ietf.org/rfc/rfc3491.txt">http://ietf.org/rfc/rfc3491.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3492">RFC3492</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Costello, A., &quot;Punycode: A 
      Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)&quot;, RFC 
      3492, March 2003.<br>
      <a href="http://ietf.org/rfc/rfc3492.txt">http://ietf.org/rfc/rfc3492.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3743">RFC3743</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Konishi, K., Huang, K., Qian, H. 
      and Y. Ko, &quot;Joint Engineering Team (JET) Guidelines for Internationalized Domain Names (IDN) 
      Registration and Administration for Chinese, Japanese, and Korean&quot;, RFC 3743, April 2004.<br>
      <a href="http://ietf.org/rfc/rfc3743.txt">http://ietf.org/rfc/rfc3743.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="RFC3986">RFC3986</a>]</span></td>
      <td class="noborder" valign="top"><span>T. Berners-Lee, R. Fielding, L. Masinter. &quot;Uniform 
      Resource Identifier (URI): Generic Syntax&quot;, RFC 3986, January 2005.<br>
      <a href="http://ietf.org/rfc/rfc3986.txt">http://ietf.org/rfc/rfc3986.txt</a></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="RFC3987">RFC3987</a>]</span></td>
      <td class="noborder" valign="top"><span>M. Duerst, M. Suignard. &quot;Internationalized Resource 
      Identifiers (IRIs)&quot;, RFC 3987, January 2005.<br>
      <a href="http://ietf.org/rfc/rfc3987.txt">http://ietf.org/rfc/rfc3987.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="UCD">UCD</a>]</td>
      <td class="noborder" valign="top">Unicode Character Database.<br>
      <a href="http://www.unicode.org/ucd">http://www.unicode.org/ucd<br>
      </a><i>For an overview of the Unicode Character Database and a list of its associated files</i></td>
    </tr>
    <tr>
      <td class="noborder" vAlign="top" width="1">[<a name="UAX15">UAX15</a>]</td>
      <td class="noborder" vAlign="top">
      <p align="left">UAX #15: Unicode Normalization Forms<br>
      <a href="http://www.unicode.org/reports/tr15/">http://www.unicode.org/reports/tr15/</a></td>
    </tr>
    <tr>
      <td class="noborder" vAlign="top">[<a name="UAX24">UAX24</a>]</td>
      <td class="noborder" vAlign="top">UAX #24, Script Names<br>
      <a href="http://unicode.org/reports/tr24/">http://unicode.org/reports/tr24/</a> </td>
    </tr>
    <tr>
      <td class="noborder" vAlign="top">[<a name="UAX31">UAX31</a>]</td>
      <td class="noborder" vAlign="top">UAX #31, Identifier and Pattern Syntax<br>
      <a href="http://www.unicode.org/reports/tr31/">http://www.unicode.org/reports/tr31/</a></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Unicode">Unicode</a>]</td>
      <td class="noborder" valign="top">The Unicode Standard, Version 4.1.0<br>
      <a href="http://www.unicode.org/versions/Unicode4.1.0/">
      http://www.unicode.org/versions/Unicode4.1.0</a>/</td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Versions">Versions</a>]</td>
      <td class="noborder" valign="top">Versions of the Unicode Standard<br>
      <a href="http://www.unicode.org/standard/versions">http://www.unicode.org/standard/versions<br>
      </a><i>For information on version numbering, and citing and referencing the Unicode Standard, 
      the Unicode Character Database, and Unicode Technical Reports.</i></td>
    </tr>
  </table>
  <h2>&nbsp;</h2>
  <h2><a name="Modifications">Modifications</a></h2>
  <p>The following summarizes modifications from the previous revision of this document.</p>
  <p><span class="changedSpan"><b>Revision 3:</b></span></p>
  <ul>
    <li><span class="changedSpan">Cleaned up references</span></li>
    <li><span class="changedSpan">Added <a href="#Related_Material">Related Material</a> section</span></li>
    <li><span class="changedspan">Add section on <a href="#Case_Folded_Format">Case_Folded_Format</a></span></li>
    <li><span class="changedSpan">Refined recommendations on whole-script confusables</span></li>
    <li><span class="changedSpan">Reorganized introduction, and reversed the order of the main 
    sections.</span></li>
    <li><span class="changedSpan">Retitled the main sections</span></li>
    <li><span class="changedSpan">Restructured the recommendations for Visual Security</span></li>
    <li><span class="changedSpan">Added more examples</span></li>
    <li><span class="changedspan">Incorporated changes pointed out by Marcos Sanz</span></li>
  </ul>
  <p><b>Revision 2:</b></p>
  <ul>
    <li><span>Moved recommendations to separate section</span></li>
    <li><span>Added new descriptions, recommendations</span></li>
    <li><span>Pointed to draft data files.</span></li>
  </ul>
  <p><b>Revision 1:</b></p>
  <ul>
    <li>Initial version, following proposal to UTC</li>
    <li>Incorporated comments, restructured, added To Do items</li>
  </ul>
  <hr>
  <p class="copyright">Copyright © 2004-2005 Unicode, Inc. All Rights Reserved. The Unicode 
  Consortium makes no expressed or implied warranty of any kind, and assumes no liability for errors 
  or omissions. No liability is assumed for incidental and consequential damages in connection with 
  or arising out of the use of the information or programs contained or accompanying this technical 
  report. The Unicode <a href="http://www.unicode.org/copyright.html">Terms of Use</a> apply.</p>
  <p class="copyright">Unicode and the Unicode logo are trademarks of Unicode, Inc., and are 
  registered in some jurisdictions.</div>

</body>

</html>
