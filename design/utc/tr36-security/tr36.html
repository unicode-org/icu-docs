<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en-us">
<link rel="stylesheet" href="../reports.css" type="text/css">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>UTR# 36: Security Considerations in the Implementation of Unicode and Related Technology
</title>
<style type="text/css">
<!--
span.special { text-decoration: underline; font-weight: bold; color: #FF0000;font-family: monospace; font-size: 12px }
.idn-head { font-size: 12px; background-color: #C0C0C0 }
span.mono    { font-family: monospace; font-size: 12px }
.idn-example {font-size:12px; font-family:Arial Unicode MS, san-serif}
span.border {background-color: white; color: red; border-left: 1px solid  blue; border-right: 1px solid blue}
-->
</style>
</head>

<body>

<table class="header" cellspacing="0" cellpadding="0" width="100%">
  <tr>
    <td class="icon"><a href="http://www.unicode.org">
    <img align="middle" alt="[Unicode]" border="0" src="http://www.unicode.org/webscripts/logo60s2.gif" width="34" height="33"></a>&nbsp;&nbsp;<a class="bar" href="http://www.unicode.org/unicode/reports">Technical 
    Reports</a></td>
  </tr>
  <tr>
    <td class="gray">&nbsp;</td>
  </tr>
</table>
<div class="body">
  <h2 align="center"><font color="#FF0000">Draft</font> Unicode Technical Report #36</h2>
  <h1>Security Considerations for the Implementation of Unicode and Related Technology</h1>
  <table border="1" cellpadding="2" width="100%" style="border-collapse: collapse" cellspacing="0">
    <tr>
      <td valign="top">Authors</td>
      <td valign="top">Mark Davis (<a href="mailto:mark.davis@us.ibm.com">mark.davis@us.ibm.com</a>)</td>
    </tr>
    <tr>
      <td valign="top">Date</td>
      <td valign="top" class="old_changed">2005-02-22</td>
    </tr>
    <tr>
      <td valign="top">This Version</td>
      <td valign="top"><a href="http://www.unicode.org/reports/tr36/tr36-2.html">
      http://www.unicode.org/reports/tr36/tr36-2.html</a></td>
    </tr>
    <tr>
      <td valign="top">Previous Version</td>
      <td valign="top"><a href="http://www.unicode.org/reports/tr36/tr36-1.html">
      http://www.unicode.org/reports/tr36/tr36-1.html</a></td>
    </tr>
    <tr>
      <td valign="top">Latest Version</td>
      <td valign="top"><a href="http://www.unicode.org/reports/tr36/">
      http://www.unicode.org/reports/tr36/</a></td>
    </tr>
    <tr>
      <td valign="top">Revision</td>
      <td valign="top">3</td>
    </tr>
  </table>
  <h3>&nbsp;</h3>
  <h3><i>Summary</i></h3>
  <p><i>This document describes security considerations that are important to be aware of when 
  working with Unicode<span>, and provides specific recommendations for dealing with the issues that 
  arise.</span></i></p>
  <h3><i>Status</i></h3>
  <p><i>This is a<b><font color="#ff3333"> draft </font></b>document which may be updated, replaced, 
  or superseded by other documents at any time. Publication does not imply endorsement by the 
  Unicode Consortium.&nbsp; This is not a stable document; it is inappropriate to cite this document 
  as other than a work in progress.</i></p>
  <blockquote>
    <p class="old_changed"><i><b>A Unicode Technical Report (UTR) </b>contains informative material. 
    Conformance to the Unicode Standard does not imply conformance to any UTR. Other specifications, 
    however, are free to make normative references to a UTR.</i></p>
  </blockquote>
  <p class="old_changed"><i>Please submit corrigenda and other comments with the online reporting 
  form [<a href="#Feedback">Feedback</a>]. Related information that is useful in understanding this 
  document is found in <a href="#References">References</a>. For the latest version of the Unicode 
  Standard see [<a href="#Unicode">Unicode</a>]. For a list of current Unicode Technical Reports see 
  [<a href="#Reports">Reports</a>]. For more information about versions of the Unicode Standard, see 
  [<a href="#Versions">Versions</a>].</i></p>
  <h3><i>Contents</i></h3>
  <ul class="toc">
    <li>1. <a href="#Introduction">Introduction</a></li>
    <li>2. <a href="#Canonical_Represenation">Canonical Representation</a><ul class="toc">
      <li>2.1 <a href="#UTF-8_Exploit">UTF-8 Exploit</a></li>
      <li>2.2 <a href="#Canonical_Representation_Recommendations">Recommendations</a></li>
    </ul>
    </li>
    <li>3. <a href="#visual_spoofing">Visual Spoofing</a><ul class="toc">
      <li>3.1. <a href="#international_domain_names">International Domain Names</a></li>
      <li>3.2 <a href="#Visual_Spoofing_Recommendations">Recommendations</a></li>
    </ul>
    </li>
    <li>4. <a href="#Data_Files">Data Files</a></li>
    <li><a href="#Related_Material">Related Material</a></li>
    <li><a href="#Acknowledgements">Acknowledgements</a></li>
    <li><a href="#References">References</a></li>
    <li><a href="#Modifications">Modifications</a></li>
  </ul>
  <blockquote>
    <p class="reviewnote"><b>Note to Reviewers:</b> The original working title was &quot;Unicode Security 
    Considerations&quot;. Should the above title be changed back to that, or changed to something else, 
    eg &quot;Unicode Security Recommendations&quot;? Feedback is welcome.</p>
  </blockquote>
  <hr>
  <h2 align="left"><a name="Introduction"></a>1. Introduction</h2>
  <p>Unicode represents a very significant advance over all previous methods of encoding characters. 
  For the first time, all of the world&#39;s characters could be represented in a uniform manner, for 
  the first time making it feasible for the vast majority of programs to be <i>globalized:</i> built 
  to handle any language in the world.</p>
  <p>In many ways, the use of Unicode makes programs much more robust and secure. When systems need 
  to use a hodge-podge of different charsets for representing characters, it was possible to take 
  advantage of differences between those charsets, or in the way in which programs converted to and 
  from them.</p>
  <p>However, because Unicode contains such a large number of characters, and because it 
  incorporates the varied writing systems of the world, incorrect usage can expose programs or 
  systems to possible security attacks. This document describes some of the security considerations 
  that should be taken into account by programmers, system analysts, standards developers, and 
  users.</p>
  <p>We anticipate that this document will grow over time, adding additional sections as needed. 
  Initially, there are two areas that will be discussed: canonical representation and visual 
  spoofing. For more information, see also the Unicode
  <a href="http://www.unicode.org/faq/security.html">FAQ on Security Issues</a>.</p>
  <p><span>Each section below presents background information on the kinds of problems that can 
  occur, then a list of specific recommendations for avoiding the problems.</span></p>
  <blockquote>
    <p class="reviewnote"><b>Note to Reviewers:</b> Some of the examples below use Unicode 
    characters which some browsers will not show, or may not show in a way that illustrates the 
    problem. For more information about improving the display, see [<a href="#Display">Display</a>]. 
    In the final version, we&#39;ll prepare GIFs for the characters where necessary.</p>
  </blockquote>
  <h2><a name="Canonical_Represenation"></a>2. Canonical Representation</h2>
  <p>A common practice is to have a &#39;gatekeeper&#39; for a system. That gatekeeper checks over incoming 
  data to ensure that it is safe, and passes only safe data through. Once in the system, the other 
  components assume that the data is safe. A problem arises when a component treats two pieces of 
  text as identical — typically by canonicalizing them to the same form — while the gatekeeper only 
  detected that one of them was unsafe.</p>
  <h3><a name="UTF-8_Exploit">UTF-8 Exploit</a></h3>
  <p>There are three equivalent encoding forms for Unicode: UTF-8, UTF-16, and UTF-32. UTF-8 is 
  commonly used in XML and HTML; UTF-16 is the most common in program APIs; and UTF-32 is the best 
  for representing single characters. While these forms are all equivalent in terms of the ability 
  to express Unicode, the original usage of UTF-8 was open to a canonicalization exploit.</p>
  <p>Up to <a href="http://www.unicode.org/unicode/uni2book/u2.html"><i>The Unicode Standard, 
  Version 3.0</i></a> the <i>generation</i> of &quot;non-shortest form&quot; UTF-8 was forbidden, as was the
  <i>interpretation</i> of illegal sequences, but not the interpretation of what was called the 
  &quot;non-shortest form&quot;. Where software does interpret the non-shortest forms, security issues can 
  arise. For example: </p>
  <ul>
    <li>Process <i>A</i> performs security checks, but does not check for non-shortest forms. </li>
    <li>Process <i>B</i> accepts the byte sequence from process <i>A</i>, and transforms it into 
    UTF-16 while interpreting non-shortest forms. </li>
    <li>The UTF-16 text may then contain characters that should have been filtered out by process <i>
    A</i>.</li>
  </ul>
  <p>For example, the backslash character &quot;\&quot; can often be a dangerous character to let through a 
  gatekeeper, since it can be used to access different directories. Thus a gatekeeper might 
  specifically prevent it from getting through. The backslash is represented in UTF-8 as the byte 
  sequence &lt;5C&gt;. However, as a non-shortest form, backslash could also be represented as the byte 
  sequence&lt;C1 9C&gt;. When a gatekeeper doesn&#39;t catch that, but a component converts non-shortest 
  forms, it can allow a real security breach. For more information, see <span class="changedSpan">[<a href="#Related_Material">Related 
  Material</a>]</span>.</p>
  <p>To address this issue, the Unicode Technical Committee modified the definition of UTF-8 in
  <a href="http://www.unicode.org/reports/tr27/">Unicode 3.1</a> to forbid conformant 
  implementations from interpreting non-shortest forms for
  <a href="http://www.unicode.org/glossary/#BMP_character">BMP characters</a>, and clarified some of 
  the conformance clauses.</p>
  <p class="reviewnote"><b>Note to Reviewers:</b> <b>To Do:</b></p>
  <p class="reviewnote">Add information about other possible exploits in this area:</p>
  <ul>
    <li>
    <p class="reviewnote">Unicode Normalization</li>
    <li>
    <p class="reviewnote">Case mapping</li>
    <li>
    <p class="reviewnote">Buffer overflows with all of the above, and when converting encoding forms</li>
    <li>
    <p class="reviewnote">Discuss Unicode properties. Eg more characters have numeric properties 
    than developers might expect.</li>
    <li>
    <p class="reviewnote">Discuss use of Regular Expressions in validating data — ensuring that the 
    Regular Expression Engine follows the Unicode Guidelines, but also that use of regular 
    expressions makes use of properties rather than fixed lists of characters.</li>
    <li>
    <p class="reviewnote"><span>Explain that private use characters can cause security problems, and 
    recommend strongly against their use.</span></li>
    <li>
    <p class="reviewnote"><span>Discuss security issues in Collation (sorting, searching, matching)</span></li>
  </ul>
  <h4><b><i><a name="Canonical_Representation_Recommendations">Recommendations</a></i></b></h4>
  <ol>
    <li>Ensure that all implementations of UTF-8 used in a system are conformant to the latest 
    version of Unicode.</li>
  </ol>
  <h2><a name="visual_spoofing"></a>3. Visual Spoofing</h2>
  <p>Visual spoofing is where a similarity in visual appearance fools a user, and causes him or her 
  to take unsafe actions. This is not new to Unicode: it was possible to spoof simply with ASCII 
  character: &quot;<font face="sans-serif">inteI.com</font>&quot; for example, uses a capital I instead of an 
  L. The infamous example here is of course &quot;<font face="sans-serif">paypaI.com</font>&quot;:&nbsp; </p>
  <blockquote>
    <p class="stBodyText"><font size="2">... Not only was &quot;Paypai.com&quot; very convincing, but the scam 
    artist even goes one step further. He or she is apparently emailing PayPal customers, saying 
    they have a large payment waiting for them in their account.</font></p>
    <p class="stBodyText"><font size="2">The message then offers up a link, urging the recipient to 
    claim the funds. But the URL that is displayed for the unwitting victim uses a capital &quot;i&quot; (I), 
    which looks just like a lowercase &quot;L&quot; (l), in many computer fonts. ...</font></p>
    <p class="stBodyText" align="right"><span class="h1"><font size="2">— </font>
    <a href="http://news.zdnet.co.uk/internet/security/0,39020375,2080344,00.htm"><font size="2">
    Beware the &#39;PaypaI&#39; scam</font></a></span></p>
  </blockquote>
  <p>And the spoofs nowadays are pretty clever. One is an email that looks like it comes from a 
  trusted source, like your bank. It even has an explicit disclaimer to not trust links in email, 
  and directs you to copy text to your address bar in your browser. The text looks ok to you, so you 
  won&#39;t realize that you are going to a completely different site, which is then set up to simulate 
  your bank well enough to get your password.</p>
  <p><span>These spoofs depend on the use of <i>visually confusable</i> strings: two different 
  strings of Unicode characters whose appearance in common fonts in small sizes at screen 
  resolutions is sufficiently close that people easily mistake one for the other.</span></p>
  <p><span>There are no hard-and-fast rules for visual confusability: it is of course possible to 
  make any characters look like any others with a suitably faulty font. By &quot;small-sizes at screen 
  resolutions&quot;, this means fonts whose ascent + descent is from 9 to 12 pixels for most scripts, 
  somewhat larger for scripts where the font size users typically have is larger, such as Japanese. 
  Of course, at sufficiently small sizes, such as 4px, a great many characters would become 
  confusable. In some cases sequences of characters can be used to spoof: for example, &quot;rn&quot; (&quot;r&quot; 
  followed by &quot;n&quot;) in many sans-serif fonts is visually confusable with &quot;m&quot;. Where two different 
  strings are essentially identical in most fonts at all sizes, they are called <i>homographs</i>. 
  However, spoofing is not dependent on just homographs; if the visual appearance is close enough at 
  small sizes, that can be sufficient to cause problems.</span></p>
  <p><span>Note that characters are not visually confusable if the positioning of the glyph is 
  sufficiently different. For example, foo·com (using the hyphenation point instead of the period) 
  should be distinguishable from foo.com by the positioning of the dot (except in faulty fonts).</span></p>
  <p>To a certain extent, the new forms of visual spoofing available with Unicode are a matter of 
  degree and not kind. However, because of the very large number of Unicode characters (over 94,000 
  in the current version), the number of opportunities for visual spoofing are significantly larger 
  than with a restricted character set such as ASCII.</p>
  <p><span>For examples of visually confusable characters, see [<a href="#confusables">confusables</a>].</span></p>
  <h3><a name="international_domain_names"></a>International Domain Names</h3>
  <p>Spoofing is an especially important subject given the recent introduction of international 
  domain names (IDN). There is a natural desire for people to see domain names in their own 
  languages and writing systems; English speakers can understand this if they consider what it would 
  be like if they always had to type web addresses with Russian characters! So IDN represents a very 
  significant advance for most people in the world. The avoidance of spoofing vulnerability requires 
  proper implementation in browsers and other programs, <span>so as to minimize security risks 
  without making the use of non-ASCII characters too onerous.</span></p>
  <p>International domain names are, of course, not the only cases where visual spoofing can occur. 
  For example, you might get a message asking you to allow the installation of software from &quot;IBM&quot;, 
  authenticated with the proper Verisign certificate, but the &quot;M&quot; character happens to be the 
  Russian (Cyrillic) character that looks precisely like the English &quot;M&quot;. <span><i>Any place where 
  strings are used as identifiers is subject to this kind of spoofing.</i> For more information on 
  identifers, see <a href="http://www.unicode.org/reports/tr31/">UAX #31: <i>Identifier and Pattern 
  Syntax</i></a>.</span></p>
  <p>However, IDN provides a good starting point for a discussion of visual spoofing. The good news 
  is that the design of IDN prevents a huge number of spoofing attacks. All conformant users of IDN 
  are required to process domain names to convert <i>
  <a href="http://www.unicode.org/glossary/#compatibility_equivalent">compatibility-equivalent</a></i> 
  characters into a unique form; this processing eliminates most of the possibilities for visual 
  spoofing by mapping away a large number of visually confusable characters and sequences. For 
  example, Unicode contains the &quot;<font SIZE="3">ä&quot; (a-umlaut) character, but also contains a 
  free-standing umlaut (&quot;¨&quot;) which can be used in combination with any character, including an &quot;a&quot;. 
  But the compatibility normalization will convert any sequence of &quot;a&quot; plus &quot;¨&quot; into the regular
  </font>&quot;<font SIZE="3">ä&quot;. </font></p>
  <p>Thus you can&#39;t spoof an <i>a-umlaut</i> with <i>a + umlaut</i>; it simply results in the same 
  domain name. See example 1 below. The String column shows the actual characters; the UTF-16 shows 
  the underlying encoding, while the IDNA column shows the IDNA format used to represent the string 
  internally in International Domain Names.</p>
  <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold"><b>Safe Domain Names</b></caption>
    <tr>
      <th class="idn-head">&nbsp;</th>
      <th class="idn-head">String</th>
      <th class="idn-head">UTF-16</th>
      <th class="idn-head">IDNA</th>
    </tr>
    <tr>
      <th class="idn-head">1a</th>
      <td class="idn-example">ät.com</td>
      <td class="mono"><span class="special">0061 0308</span><span class="mono"> 0074 002E 0063 006F 
      006D</span></td>
      <td><span class="mono">xn--t-zfa.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">1b</th>
      <td class="idn-example">ät.com</td>
      <td class="mono"><span class="special">00E4</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
      <td class="mono"><span class="mono">xn--t-zfa.com</span></td>
    </tr>
  </table>
  <blockquote>
    <p><b>Note: </b>The ICU demo at <span class="changedSpan">[<a href="#IDN-Demo">IDN-Demo</a>]</span> 
    can be used to demonstrate the results of processing different domain names. That demo was also 
    used to get the IDNA values shown here.</p>
  </blockquote>
  <p><span>The IDN processing also removes case distinctions by performing a <i>case folding</i> to 
  reduce characters to a lowercase form<i>.</i> This is also useful for avoiding spoofing problems, 
  since characters are generally more distinctive in their lowercase forms. That means that we can 
  focus on just the lowercase characters.</span></p>
  <p><span>For a list of allowable characters in IDN, see [<a href="#idn-chars">idn-chars</a>]. 
  There are many misperceptions about which characters are allowed in IDN, so referencing this 
  explicit list should be useful for dispelling some of them. The characters are those left after 
  string processing has been performed, so case-folding and normalization have already been applied.
  </span></p>
  <p><span>Although normalization and case-folding prevent many possible spoofing attacks, </span>
  there remain many cases where visual spoofing can still occur with international domain names.
  <span>Ideally, much of this would be handled on the registries&#39; side instead of user-agents 
  (browsers, emailers, and other programs that display and process URLs). The registry has the most 
  data available, and process it the most efficiently at the time of registration, using policies to 
  reduce visual spoofing. For example, given confusable mapping data, the registry can easily 
  determine if a proposed registration conflicts with an existing one; that is much more difficult 
  for user agents because of the sheer number of combinations that it would have to probe.</span></p>
  <p><span>However:</span></p>
  <ul>
    <li><span>the user agent has more control over the display of characters, which is crucial to 
    spoofing</span></li>
    <li><span>there are legitimate cases of visually confusable characters that one may want to 
    allow <i>after</i> alerting the user.</span></li>
    <li><span>one cannot depend on all registries being equally responsive to security issues</span></li>
  </ul>
  <p><span>So efforts need to be made on the part of user-agents as an additional line of defense.</span></p>
  <blockquote>
    <p><span><b>Note: </b>since the top-level domain names (TLD: .com, .ru, etc.) is currently 
    always ASCII, all discussions below of the domain names pertain to all but the top level.</span></p>
  </blockquote>
  <h3><b>Cross-Script Spoofing</b></h3>
  <p>Visually confusable characters are not usually unified across scripts. Thus a Greek <i>omicron</i> 
  is encoded as a different character from the Latin &quot;o&quot;, even though it is usually identical <span>
  or nearly identical</span> in appearance. <span>There are good reasons for this: often the 
  characters were separate in legacy encodings, and preservation of those distinctions was necessary 
  for existing data to be mapped to Unicode without loss. Moreover, the characters generally have 
  very different behavior: two visually confusable characters may be different in casing behavior, 
  in category (letter vs. number), or in numeric value. After all, ASCII doesn&#39;t unify lowercase L 
  and digit 1, even though those are visually confusable. Encoding the Cyrillic character б 
  (corresponding to the letter &quot;b&quot;) by using the numeral 6, would clearly have been a mistake, even 
  though they are visually confusable.</span></p>
  <p><span>However, the existence of these cases </span>means that there is a significant number of 
  spoofing possibilities using characters from different scripts. For example, a domain name can be 
  spoofed by using a Greek omicron instead of an &#39;o&#39;, as in example 2a.</p>
  <table id="AutoNumber2" style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold"><b>Cross-Script Spoofing</b></caption>
    <tr>
      <th class="idn-head">&nbsp;</th>
      <th class="idn-head">String</th>
      <th class="idn-head">UTF-16</th>
      <th class="idn-head">IDNA</th>
    </tr>
    <tr>
      <th class="idn-head">2a</th>
      <td class="idn-example">tοp.com</td>
      <td><span class="mono">0074 </span><span class="special">03BF</span><span class="mono"> 0070 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--tp-jbc.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">2b</th>
      <td class="idn-example">tοp.com</td>
      <td><span class="mono">0074 </span><span class="special">006F</span><span class="mono"> 0070 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">top.com</span></td>
    </tr>
  </table>
  <p>There are many legitimate uses of mixed scripts. <span>Because of the prevalence of Latin 
  characters, </span>it is quite common, for example, to use English words (with Latin characters) 
  in the middle of other languages using other scripts. <span>For example, one could have XML-документы.com 
  (which would be a site for &quot;XML documents&quot; in Russian). Even in English, legitimate product or 
  organization names may contain non-Latin characters, such as Ωmega, Teχ, Toys-Я-Us, or HλLF-LIFE. 
  The lack of IDNs in the past has also led to the usage in some registries (such as the .ru TLD) 
  where Latin names have been used to create pseudo-cyrillic names in the .ru tld. For example, see
  <a href="http://caxap.ru/">http://caxap.ru/</a> (сахар means sugar in Russian)</span>.</p>
  <p>The Unicode Standard supplies information that can be used for detecting mixed-script text: for 
  more information, see UAX #24: <i><a href="http://www.unicode.org/reports/tr24/">Script Names</a></i>.</p>
  <p><span>Cyrillic and Latin represent special challenges, since the number of common glyphs shared 
  between them is so high, as can be seen from [<a href="#idn-chars">idn-chars</a>]. It may be 
  possible to compose an entire domain name (except the TLD) in Cyrillic using letters that will be 
  essentially always identical in form to Latin letters, such as &quot;scope.com&quot;: with &quot;scope&quot; in 
  Cyrillic looking just like &quot;scope&quot; in Latin. These are called <i>whole-script confusables.</i></span></p>
  <h3>In-Script Spoofing</h3>
  <p>While compatibility normalization and mixed-script detection can handle the vast majority of 
  cases, there are other visual confusables that could cause problems. With fonts increasingly able 
  to handle international characters, and <i>especially</i> with smaller font sizes in the context 
  of an address bar, these visual confusables could be used to spoof. Importantly, these problems 
  can be illustrated with common, widely available fonts on widely available operating systems
  <font face="Lucida Sans Unicode">—</font> this is not pointing a finger at any one vendor.</p>
  <p>Consider the following examples, all in the same script. In each numbered case, in commonly 
  available browsers, the strings will look identical.</p>
  <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold"><b>Spoofed Domain Names</b></caption>
    <tr>
      <th class="idn-head">&nbsp;</th>
      <th class="idn-head">String</th>
      <th class="idn-head">UTF-16</th>
      <th class="idn-head">IDNA</th>
    </tr>
    <tr>
      <th class="idn-head">3a</th>
      <td class="idn-example">a‐b.com</td>
      <td><span class="mono">0061 </span><span class="special">2010</span><span class="mono"> 0062 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ab-v1t.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">3b</th>
      <td class="idn-example">a-b.com</td>
      <td><span class="mono">0061 </span><span class="special">002D</span><span class="mono"> 0062 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">a-b.com</span></td>
    </tr>
    <tr>
      <th colSpan="4" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">4a</th>
      <td class="idn-example">so̷s.com</td>
      <td><span class="mono">0073 </span><span class="special">006F 0337</span><span class="mono"> 
      0073 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--sos-rjc.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">4b</th>
      <td class="idn-example">søs.com</td>
      <td><span class="mono">0073 </span><span class="special">00F8</span><span class="mono"> 0073 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ss-lka.com</span></td>
    </tr>
    <tr>
      <th colSpan="4" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">5a</th>
      <td class="idn-example">z̵o.com</td>
      <td><span class="special">007A 0335</span><span class="mono"> 006F 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--zo-pyb.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">5b</th>
      <td class="idn-example">ƶo.com</td>
      <td><span class="special">01B6</span><span class="mono"> 006F 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--o-zra.com</span></td>
    </tr>
    <tr>
      <th colSpan="4" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">6a</th>
      <td class="idn-example">an͂o.com</td>
      <td><span class="mono">0061 </span><span class="special">006E 0342</span><span class="mono"> 
      006F 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ano-0kc.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">6b</th>
      <td class="idn-example">año.com</td>
      <td><span class="mono">0061 </span><span class="special">00F1</span><span class="mono"> 006F 
      002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--ao-zja.com</span></td>
    </tr>
    <tr>
      <th colSpan="4" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">7a</th>
      <td class="idn-example">Đo.org</td>
      <td><span class="special">0110</span><span class="mono"> 006F 002E 006F 0072 0067</span></td>
      <td><span class="mono">xn--o-kia.org</span></td>
    </tr>
    <tr>
      <th class="idn-head">7b</th>
      <td class="idn-example">Ɖo.org</td>
      <td><span class="special">0189</span><span class="mono"> 006F 002E 006F 0072 0067</span></td>
      <td><span class="mono">xn--o-40a.org</span></td>
    </tr>
  </table>
  <h3>&nbsp;</h3>
  <h3>Inadequate Rendering Support</h3>
  <p>An additional problem arises when a font and/or rendering engine has inadequate support for 
  certain sequences of characters. These are characters that <i>should</i> be visually 
  distinguishable, but don&#39;t appear that way. In example 8a, the <i>a-umlaut</i> is followed by 
  another <i>umlaut</i>. The Unicode Standard guidelines indicate that the second <i>umlaut</i> 
  should be &#39;stacked&#39; above the first, producing a distinct visual difference. But as this example 
  shows, common fonts will simply superimpose the second <i>umlaut</i>; and if the positioning is 
  close enough, the user will not see a difference between 8a and 8b.</p>
  <table style="BORDER-COLLAPSE: collapse" cellSpacing="0" cellPadding="4" border="1">
    <caption style="font-size: 14pt; font-weight: bold">Inadequate Rendering Support </caption>
    <tr>
      <th bgColor="#c0c0c0" class="idn-head">&nbsp;</th>
      <th bgColor="#c0c0c0" class="idn-head">String</th>
      <th bgColor="#c0c0c0" class="idn-head">UTF-16</th>
      <th bgColor="#c0c0c0" class="idn-head">IDNA</th>
    </tr>
    <tr>
      <th class="idn-head">8a</th>
      <td><span class="mono">ä<font face="Arial Unicode MS">̈</font>t.com</span></td>
      <td><span class="special">00E4 0308</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--t-zfa85n.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">8b</th>
      <td><span class="mono">ät.com</span></td>
      <td><span class="special">00E4</span><span class="mono"> 0074 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--t-zfa.com</span></td>
    </tr>
    <tr>
      <th bgColor="#c0c0c0" colSpan="4" class="idn-head">&nbsp;</th>
    </tr>
    <tr>
      <th class="idn-head">9a</th>
      <td><span class="mono">eḷ.com</span></td>
      <td><span class="special">0065</span><span class="mono"> 006C </span><span class="special">
      0323</span><span class="mono"> 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--e-zom.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">9b</th>
      <td><span class="mono">ẹl.com</span></td>
      <td><span class="special">0065 0323</span><span class="mono"> 006C 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--l-ewm.com</span></td>
    </tr>
    <tr>
      <th class="idn-head">9c</th>
      <td><span class="mono">ẹl.com</span></td>
      <td><span class="special">1EB9</span><span class="mono"> 006C 002E 0063 006F 006D</span></td>
      <td><span class="mono">xn--l-ewm.com</span></td>
    </tr>
  </table>
  <p>In example 9, we have an even worse case. The <i>underdot</i> character in 9a is <i>actually</i> 
  under the &#39;l&#39;, but in many fonts, it appears as under the &#39;e&#39;! It is thus visually confusable with 
  9b (where the <i>underdot</i> is under the e) or the equivalent normalized form 9c.</p>
  <h3><span>Syntax Spoofing</span></h3>
  <p><span>Spoofing syntax characters can be even worse than regular characters. For example, U+2044 
  &#39;<span title="U+2044 FRACTION SLASH">⁄&#39; <span style="font-variant: small-caps">FRACTION SLASH</span> 
  can look like &#39;/&#39; in many fonts (ideally the spacing and angle is sufficiently different as to be 
  distinguishable, but this is not always maintained. </span>This allows the following name:</span></p>
  <blockquote>
    <p><span>http://example.org/not.mydomain.com</span></p>
  </blockquote>
  <p><span>to pretend to be a subdomain in </span></p>
  <blockquote>
    <p><span>http://example.org</span></p>
  </blockquote>
  <p><span>whereas it is actually the subzone <i>&quot;example.org/not&quot;</i> in the domain</span></p>
  <blockquote>
    <p>http://<span>mydomain.com</span></p>
  </blockquote>
  <p><span>Thus anything that is visually similar to &#39;.&#39;, &#39;/&#39;, &#39;#&#39;, is especially dangerous. Most of 
  these cases, such as U+2024 (·) <span style="font-variant: small-caps">ONE DOT LEADER</span> are 
  disallowed by StringPrep [<a href="#RFC3454">RFC3454</a>], but not all.</span></p>
  <p><span class="changedSpan">Of course, this approach can also work even without IDN, where the 
  user is fooled into thinking that the domain name is the first part of the URL, not where it 
  actually is. For example, in the following the real domain name, mydomain.com, is also obscured 
  for the casual user.</span></p>
  <blockquote>
    <p><span class="changedSpan"><span>http://example.org</span>--long-and-obscure-list-of-characters.<span>mydomain.com</span></span></p>
  </blockquote>
  <p><span class="changedSpan">In retrospect, it would have been much better if domain names were 
  customarily written with &quot;most significant part first&quot;. The following <i>hypothetical</i> display 
  would be harder to spoof: the fact that it is &quot;com.mydomain&quot; is not as easily lost.</span></p>
  <blockquote>
    <p><span class="changedSpan"><span>http://com.mydomain.org/not.example<br>
    http://com.mydomain.org</span>--long-and-obscure-list-of-characters.<span>example</span></span></p>
  </blockquote>
  <p><span class="changedSpan"><span>But that would be an impossible change at this point: those 
  horses have long since left the barn. However, what could be done now is to always visually 
  highlight the second-level domain, eg:</span></span></p>
  <blockquote>
    <p><span class="changedSpan"><span>http://<b><font color="#0000FF">example</font></b>.org</span><br>
    http://<span><b><font color="#0000FF">mydomain</font></b>.com</span><br>
    <span>http://example.org/not.<b><font color="#0000FF">mydomain</font></b>.com</span><br>
    <span>http://example.org</span>--long-and-obscure-list-of-characters.</span><span><span class="changedSpan"><b><font color="#0000FF">mydomain</font></b>.com</span></span></p>
  </blockquote>
  <p><span>It is important also not to show a missing glyph or character with a simple &quot;?&quot;, since 
  that makes every such character be visually confusable with a real question mark. Instead, follow 
  the Unicode guidelines for displaying missing glyphs using a rounded-rectangle, as described in 
  Section <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.3 <i>Unknown and Missing 
  Characters</i></a> of [<a href="#Unicode">Unicode</a>].&nbsp; For examples of this, see also [<a href="#Charts">Charts</a>].</span></p>
  <h3><span>Numeric Spoofs</span></h3>
  <p><span>Turning away from IDN for a moment, there is another area where visual spoofs can be 
  used. Many scripts have sets of decimal digits that are different in shape from the typical 
  European digits {0 1 2 3 4 5 6 7 8 9}. For example, Bengali has
  <span title="U+09E6 BENGALI DIGIT ZERO">{০ </span><span title="U+09E7 BENGALI DIGIT ONE">১</span><span title="U+09F4 BENGALI CURRENCY NUMERATOR ONE">
  </span><span title="U+09E8 BENGALI DIGIT TWO">২</span><span title="U+09F5 BENGALI CURRENCY NUMERATOR TWO">
  </span><span title="U+09E9 BENGALI DIGIT THREE">৩ </span><span title="U+09EA BENGALI DIGIT FOUR">৪
  </span><span title="U+09EB BENGALI DIGIT FIVE">৫ </span><span title="U+09EC BENGALI DIGIT SIX">৬
  </span><span title="U+09ED BENGALI DIGIT SEVEN">৭ </span><span title="U+09EE BENGALI DIGIT EIGHT">
  ৮ </span><span title="U+09EF BENGALI DIGIT NINE">৯}, while Oriya has </span>{<span title="U+0B66 ORIYA DIGIT ZERO">୦
  </span><span title="U+0B67 ORIYA DIGIT ONE">୧ </span><span title="U+0B68 ORIYA DIGIT TWO">୨ </span>
  <span title="U+0B69 ORIYA DIGIT THREE">୩ </span><span title="U+0B6A ORIYA DIGIT FOUR">୪ </span>
  <span title="U+0B6B ORIYA DIGIT FIVE">୫ </span><span title="U+0B6C ORIYA DIGIT SIX">୬ </span>
  <span title="U+0B6D ORIYA DIGIT SEVEN">୭ </span><span title="U+0B6E ORIYA DIGIT EIGHT">୮ </span>
  <span title="U+0B6F ORIYA DIGIT NINE">୯}. While the sets taken as a whole are different in shape, 
  individual digits may have the same shapes as digits from other scripts, even digits of different 
  values. For example, the string </span><b><span title="U+09EA BENGALI DIGIT FOUR">৪</span></b><span title="U+0B68 ORIYA DIGIT TWO"><b>୨</b> 
  is visually confusable with <b>89</b> (at small sizes), but actually has the numeric value 42! 
  Where software simply interprets the numeric value of a string of digits, without detecting that 
  the digits are from different scripts, it is possible to generate such spoofs.</span></span></p>
  <h3><span><a name="Visual_Spoofing_Recommendations">Recommendations</a></span></h3>
  <p><span>We are in the process of gathering data that would allow for a finer-grained approach, 
  but until such time as that is more comprehensive, we&#39;d recommend having a more conservative 
  stance. It is always easier to widen restrictions than narrow them. We do expect these 
  recommendations to be refined over time.</span></p>
  <p><span>Some people have proposed prevention of spoofing by restricting domain names according to 
  language. In practice, that is very problematic. It is very difficult to determine the intended 
  language of many terms, especially product or company names, which are often constructed to be 
  neutral regarding language. Moreover, languages tend to be quite fluid; foreign words are 
  continually being adopted. Except for registries with very special policies (such as the blocking 
  used by some East Asian registries such as described in [<a href="#RFC3743">RFC3743</a>]), the 
  language association doesn&#39;t make too much sense. </span></p>
  <p><span>Instead, what is recommended is a combination of string preprocessing to remove basic 
  equivalences, promoting adequate rendering support, and putting restrictions in place according to 
  script and restricting by confusable characters. While the ICANN guidelines say &quot;top-level domain 
  registries will (a) associate each registered internationalized domain name with one language or 
  set of languages&quot; (<a href="http://www.icann.org/general/idn-guidelines-20jun03.htm">http://www.icann.org/general/idn-guidelines-20jun03.htm</a>), 
  that is better interpreted as limiting to script rather than language.</span></p>
  <p><span>In the following recommendations:</span></p>
  <ul>
    <li><span>&quot;appropriate alerts&quot; are recommended. The form of such alerts could be minimal, such 
    as special coloring or icons (perhaps with a tool-tip for more information), or more 
    in-your-face, such as an alert dialog describing the issue and requiring user confirmation 
    before continuing. The strength of the alert can be scaled according to the level of the 
    potential problem. The user-agent could also remember when the user has accepted an alert, for 
    say Ωmega.com, and permit future access without bothering the user again with an alert.</span></li>
    <li>t<span>he term &quot;Registry&quot; is to be interpreted broadly. The .com operator can impose 
    restrictions on the 2nd level domain label, but if someone registers foo.com, then it&#39;s up to 
    them to decide what will be allowed at the 3rd level (e.g. bar.foo.com). So for that purpose, 
    the owner of foo.com is treated as the &quot;registry&quot; for the 3rd level (the &#39;bar&#39;). The term 
    &quot;Registrant&quot; is used to refer to someone applying to a registry for a domain name.</span></li>
  </ul>
  <p><span>Also see the security discussions in IRI [<a href="#RFC3987">RFC3987</a>], URI [<a href="#RFC3986">RFC3986</a>], 
  and StringPrep [<a href="#RFC3454">RFC3454</a>].</span></p>
  <ol type="I">
    <li>
    <h4><span>General</span></h4>
    <ol>
      <li><span>In checking equivalence of identifiers, preprocess both strings by applying NFKC and 
      case folding. An example of this methodology is StringPrep [<a href="#RFC3454">RFC3454</a>]. 
      Display all such identifiers to users in their post-processed form. That will, for example, 
      always map characters to lowercase, where characters are generally more distinctive.</span><ul>
        <li><span>Although StringPrep itself is currently limited to Unicode 3.2, the same 
        methodology can be applied by implementations that need to support more modern versions of 
        Unicode.</span></li>
      </ul>
      </li>
      <li><span>Disallow the use of non-spacing marks at the start of an identifier, since those 
      will often be clipped in display.</span></li>
      <li><span>Assess the font support of the OS/platform according to draft UTR #32: <i>Assessing 
      Unicode Support (to be issued soon)</i>. See also the W3C [<a href="#CharMod">CharMod</a>]. If 
      it is inadequate, work with the OS/platform vendor to address those problems, or implement 
      your own handling of problematic cases:</span><ol type="a">
        <li><span>Verify that accents do not appear to apply to the wrong character.</span></li>
        <li><span>Follow <a href="http://www.unicode.org/notes/tn2/">UTN #2: <i>Rendering Combining 
        Marks</i></a> in providing layout of non-spacing marks that would otherwise collide. If this 
        is not done, use the &quot;Show Hidden&quot; option of Section
        <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.13 <i>Rendering Nonspacing 
        Marks</i></a> of [<a href="#Unicode">Unicode</a>] for the display of non-spacing marks.</span></li>
        <li><span>Follow the Unicode guidelines for displaying missing glyphs using a 
        rounded-rectangle, as described in Section
        <a href="http://www.unicode.org/versions/Unicode4.0.0/ch05.pdf">5.3 <i>Unknown and Missing 
        Characters</i></a> of [<a href="#Unicode">Unicode</a>].</span></li>
      </ol>
      </li>
      <li><span>In all software that parses numbers, detect digits of mixed (or unexpected) scripts.</span></li>
    </ol>
    </li>
    <li><span><b>Domain Names: User Agents</b></span><ol type="A">
      <li><span>Follow the General recommendations above.</span></li>
      <li><span>Always display the domain name in </span>nameprepped form<span> [<a href="#RFC3491">RFC3491</a>]. 
      That will, for example, always map characters to lowercase, where characters are generally 
      more distinctive.</span></li>
      <li><span>Display the URL with fonts that shows as many distinctions as possible among the 
      visually confusable characters. For example, serifed fonts are generally better than sans 
      serif. Use a size that makes it easier to see the differences in characters. Disallow the use 
      of font sizes that are so small as to cause even more characters to be visually confusable.</span></li>
      <li><span>Provide the following optional Security Levels according to the contents of the 
      domain name (excluding the TLD). Any domain names only satisfying a higher level would 
      generate appropriate alerts. <span class="changedSpan">A breakdown of characters by script is 
      given in [<a href="#idn-chars">idn-chars</a>].</span></span><ol>
        <li><b><span>No IDN</span></b><ul>
          <li><span>ASCII only</span></li>
        </ul>
        </li>
        <li><b><span>Minimal (default -- short term)</span></b><ul>
          <li><span>any single script, or <i>Han + Hiragana + Katakana</i>, or <i>Han + Bopomofo</i>, 
          or <i>Han + Hangul</i>, </span></li>
          <li><span>plus <i>Common</i>, plus <i>Inherited</i> script characters</span></li>
          <li><span><i><b>but:</b></i></span></li>
          <li><span>exclude special-purpose characters (see [<a href="#special">special</a>])</span></li>
          <li><span><font color="#FF0000">(possible future extension)</font> exclude any combining 
          character sequences outside of NamedSequences.txt (Unicode 4.1)</span></li>
        </ul>
        </li>
        <li><b><span>Moderate = </span></b><span>Minimal + </span>
        <ul>
          <li><span>allow <i>Latin</i> with other scripts except <i>Cyrillic</i>, <i>Greek</i>, <i>
          Cherokee</i></span></li>
        </ul>
        </li>
        <li><b><span>Expanded = </span></b><span>Moderate +</span><ul>
          <li><span>allow mixtures of scripts, e.g. Ωmega.com, Teχ.org, HλLF-LIFE.com</span></li>
          <li><span>allow more excluded characters (data — TBD)</span></li>
        </ul>
        </li>
        <li><b><span>Unrestricted</span></b><ul>
          <li><span>any valid IDN, except those starting with combining marks, or using visually 
          confusable syntax characters</span></li>
        </ul>
        </li>
      </ol>
      </li>
      <li><span>Once confusable data is more comprehensive:</span><ol>
        <li>R<span>aise the default level to Level3</span></li>
        <li>A<span>lert on domain names where there is some mapping of confusable characters that 
        would result in a different domain name that would also be allowed at that security level.</span><ul>
          <li><span>For example: &quot;ѕсоре.com&quot; (with &quot;ѕсоре&quot; in <i>Cyrillic</i> looking like &quot;scope&quot; 
          in <i>Latin</i>) would cause an alert at Level 2, even though it is a single script 
          (excluding the TLD).</span></li>
        </ul>
        </li>
        <li><span class="changedSpan">If the domain name has a whole-script confusable, verify that 
        both point to the same IP address. If not, alert the user.</span></li>
      </ol>
      </li>
      <li><span class="changedSpan">Visually highlight the domain name when a URL is displayed, to 
      prevent syntax spoofs.</span></li>
    </ol>
    </li>
    <li><span><b>Domain Names: Registries</b></span><ol type="A">
      <li><span>In the short term, use Level 2 <span class="changedSpan">from &quot;User Agents&quot;</span> 
      to restrict new domain names.</span></li>
      <li><span>Once the confusable data is more comprehensive:</span><ol>
        <li>R<span>aise the allowable level to Level 5</span></li>
        <li><span class="changedSpan">Whenever a new domain name is registered, automatically give 
        the registrant any whole-script confusable variant. Thus a registration of &quot;<span>ѕсоре.com</span>&quot; 
        (<i>Cyrillic</i>) would automatically also get a registration of &quot;scope.com&quot; (<i>Latin</i>).</span></li>
        <li>Otherwise d<span>isallow registration of a new domain name that only differs by 
        confusable characters from one already registered.</span></li>
      </ol>
      </li>
    </ol>
    </li>
    <li><b><span>Domain Names: Registrants</span></b><ol type="A">
      <li><span>Verify that the Registry follows appropriate guidelines for preventing spoofing.</span></li>
      <li><span>If the desired domain name has any whole-script confusables (such as &quot;scope&quot; in 
      Latin and Cyrillic), register those as well<span class="changedspan">, if not automatically 
      provided by the registry. Use the same IP address for both.</span></span></li>
    </ol>
    </li>
  </ol>
  <hr width="50%">
  <p class="reviewnote"><b>Note to Reviewers:</b> <b>To Do:</b></p>
  <ul>
    <li>
    <p class="reviewnote"><span>Give more background as to why normalization fixes certain problems, 
    and which it does not fix. Describe how implementations of normalization can use small data set 
    limited to only supported characters. Describe the recommended use of normalization in 
    non-domain part of URL.</span></li>
    <li>
    <p class="reviewnote"><span>Describe BIDI spoofs. Use material from Michel&#39;s slides. Show how 
    reverse-bidi (visual order -&gt; storage order) can be used to detect bidi spoofs. That is: one can 
    apply bidi then reverse bidi: if the result does not match the original, then reject the string.</span></li>
    <li>
    <p class="reviewnote"><span>Explain that private use characters can cause security problems, and 
    recommend strongly against their use (not a problem for IDN, but for other identifiers it can 
    be).</span></li>
    <li>
    <p class="reviewnote"><span>Describe cases in complex languages (eg Indic) where the same visual 
    appearance may result from two different undering character sequences — <i>in the right context</i>.</span></li>
    <li>
    <p class="reviewnote"><span>Add information on spoofs that only work with contextual scripts, 
    such as Arabic.</span></li>
    <li>
    <p class="reviewnote"><span>Discuss security issues in Collation (sorting, searching, matching)</span></li>
    <li>
    <p class="reviewnote"><span>Describe how TrueType/OpenType fonts can be used in spoofing: fonts 
    are actually programs that can deform glyph shapes radically according to resolution, platform, 
    or language. For example $100.00 could appear as $200.00 when printed.</span></li>
    <li>
    <p class="reviewnote"><span>Discuss SSL and how root Certificate Authorities can be a problem, 
    but are also part of the solution; most customers would lose faith quickly in internet financial 
    transaction if SSL/https can be easily compromised</span></li>
    <li>
    <p class="reviewnote">Expand other applications of visual spoofing, aside from the example of 
    IDN. International domain names are actually in much better shape than many other areas, since 
    the problem will be much more severe in any area where text is not normalized. So focus on those 
    issues.</li>
  </ul>
  <h2><span>4. <a name="Data_Files">Data Files</a></span></h2>
  <p><span>There are three data files currently associated with this document.</span></p>
  <table cellspacing="0" cellpadding="4" border="0" class="noborder" style="border-collapse: collapse">
    <tr>
      <td class="noborder" valign="top" width="1" nowrap="nowrap"><span>[<a name="idn-chars">idn-chars</a>]</span></td>
      <td class="noborder" valign="top"><span><b>IDN Characters: </b><a href="idn-chars.html">
      idn-chars.html</a><b><br>
      </b>Lists all the possible IDN chars, after nameprep is performed. Contains all the possible 
      characters, sorted by script, then whether atomic (non-decomposible) or decomposable, then 
      according to UCA collation order. Scripts that are bicameral (have both upper and lower cases) 
      are further divided into two sets, based on whether letters have both cases or not. If your 
      browser supports tool-tips, hovering the mouse over any character will show its name and code 
      point.</span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="confusables">confusables</a>]</span></td>
      <td class="noborder" valign="top"><b>Visually Confusable Characters: </b>
      <a href="confusables.txt"><span>confusables.txt</span></a><span><br>
      The format and usage of the file are described in the file header.<i><br>
      Note: we are just starting the project of collecting this data, and examining the feasibility 
      of different approaches, so we have just begun to gather data in this file.</i></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="special">special</a>]</span></td>
      <td class="noborder" valign="top"><span><b>Special-Purpose Characters: </b>
      <a href="special_purpose.txt">special_purpose.txt</a><br>
      Characters that are not letters in common modern use, and may be disallowed at certain 
      security levels.<br>
      <i>Note: we are just starting the project of collecting this data, and examining the 
      feasibility of different approaches, so we have just begun to gather data in this file.</i></span></td>
    </tr>
  </table>
  <hr width="50%"><hr width="50%">
  <h2><span class="changedSpan"><a name="Related_Material">Related Material</a></span></h2>
  <h3><span class="changedSpan">Canonical Representation</span></h3>
  <ul>
    <li><span class="changedSpan">
    <a href="http://www.microsoft.com/technet/security/bulletin/MS00-078.mspx">Microsoft Security 
    Bulletin (MS00-078): Patch Available for &#39;Web Server Folder Traversal&#39; Vulnerability</a></span></li>
    <li><span class="changedSpan">
    <a href="http://www.ins.com/downloads/whitepapers/ins_white_paper_ms_iis_unicode_exploit_0801.pdf">
    INS: Microsoft IIS Unicode Exploit</a></span></li>
    <li><a href="http://www.nextgenss.com/papers/unicodebo.pdf">Creating Arbitrary Shellcode In 
    Unicode Expanded Strings</a></li>
  </ul>
  <h3><span class="changedSpan">Visual Spoofing</span></h3>
  <ul>
    <li><span class="changedSpan">
    <a href="http://www.cs.technion.ac.il/~gabr/papers/homograph_full.pdf">The Homograph Attack</a></span></li>
    <li><span class="changedSpan">
    <a href="http://news.zdnet.co.uk/internet/security/0,39020375,2080344,00.htm">PayPal alert! 
    Beware the &#39;PaypaI&#39; scam</a></span></li>
    <li><span class="changedSpan"><a href="http://www.icann.org/topics/news022305.html">gTLD 
    Registry Constutuency: Potential of IDN for malicious abuse</a></span></li>
    <li><span class="changedSpan"><a href="http://www.icann.org/topics/idn.html">ICANN | 
    Internationalized Domain Names</a></span></li>
    <li><span class="changedSpan"><span style="font-size: 12pt;">
    <a href="http://www.ietf.org/IESG/STATEMENTS/IDNstatement.txt" target="_blank">IESG statement of 
    11 February 2003</a></span></span></li>
    <li><span class="changedSpan"><a href="http://forum.icann.org/lists/idn-homograph/">ICANN Email 
    Archives [idn-homograph]</a></span></li>
    <li><span class="changedSpan">
    <a href="http://www.ietf.org/internet-drafts/draft-klensin-reg-guidelines-06.txt">Suggested 
    Practices for Registration of Internationalized Domain Names (IDN)</a></span></li>
    <li><span class="changedSpan"><a href="http://secunia.com/multiple_browsers_idn_spoofing_test/">
    Multiple Browsers IDN Spoofing Test</a></span></li>
  </ul>
  <h2 class="old_changed"><a name="Acknowledgements">Acknowledgements</a></h2>
  <p class="old_changed">Steven Loomis and other people on the ICU team were very helpful in 
  developing the original proposal for this technical report. Thanks also to the following people 
  for their feedback or contributions to this document <span>or earlier versions of it</span>: 
  Martin Dürst, Paul Hoffman, <span>Eric Muller, Erik van der Poel, and especially Michel Suignard. 
  This document also draws on examples or ideas suggested in email discussions from Alexander 
  Savenkov, Erik van der Poel, and others.</span></p>
  <h2><a name="References">References</a></h2>
  <table cellspacing="0" cellpadding="4" border="0" class="noborder" style="border-collapse: collapse">
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="CharMod">CharMod</a>]</span></td>
      <td class="noborder" valign="top"><span>Character Model for the World Wide Web 1.0: 
      Fundamentals<br>
      <a href="http://www.w3.org/TR/charmod/">http://www.w3.org/TR/charmod/</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="Charts">Charts</a>]</span></td>
      <td class="noborder" valign="top"><span>Unicode Charts<br>
      <a href="http://www.unicode.org/charts/">http://www.unicode.org/charts/</a></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="Display">Display</a>]</span></td>
      <td class="noborder" valign="top"><span>Display Problems?<br>
      <a href="http://www.unicode.org/help/display_problems.html">
      http://www.unicode.org/help/display_problems.html</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1" nowrap="nowrap"><span class="changedSpan"><span>[<a name="IDN-Demo">IDN-Demo</a>]</span></span></td>
      <td class="noborder" valign="top"><span class="changedSpan"><span>ICU (International 
      Components for Unicode) IDN Demo<br>
      <a href="http://ibm.com/software/globalization/icu/demo/domain/">
      http://ibm.com/software/globalization/icu/demo/domain/</a></span></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Feedback">Feedback</a>]</td>
      <td class="noborder" valign="top">Reporting Errors and Requesting Information Online<i><br>
      </i><a href="http://www.unicode.org/reporting.html">http://www.unicode.org/reporting.html</a></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><a name="Reports">Reports</a>]</td>
      <td class="noborder" valign="top">Unicode Technical Reports<br>
      <a href="http://www.unicode.org/reports/">http://www.unicode.org/reports/<br>
      </a><i>For information on the status and development process for technical reports, and for a 
      list of technical reports.</i></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="RFC3454">RFC3454</a>]</span></td>
      <td class="noborder" valign="top"><span>P. Hoffman, M. Blanchet. &quot;Preparation of 
      Internationalized Strings (&quot;stringprep&quot;)&quot;, RFC 3454, December 2002.<br>
      <a href="http://ietf.org/rfc/rfc3454.txt">http://ietf.org/rfc/rfc3454.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3490">RFC3490</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Faltstrom, P., Hoffman, P. and A. 
      Costello, &quot;Internationalizing Domain Names in Applications (IDNA)&quot;, RFC 3490, March 2003.<br>
      http://ietf.org/rfc/rfc3490.txt</span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3491">RFC3491</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Hoffman, P. and M. Blanchet, &quot;Nameprep: 
      A Stringprep Profile for Internationalized Domain Names (IDN)&quot;, RFC 3491, March 2003.<br>
      http://ietf.org/rfc/rfc3491.txt</span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3492">RFC3492</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Costello, A., &quot;Punycode: A 
      Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)&quot;, RFC 
      3492, March 2003.<br>
      http://ietf.org/rfc/rfc3492.txt</span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span class="changedSpan">[<a name="RFC3743">RFC3743</a>]</span></td>
      <td class="noborder" valign="top"><span class="changedSpan">Konishi, K., Huang, K., Qian, H. 
      and Y. Ko, &quot;Joint Engineering Team (JET) Guidelines for Internationalized Domain Names (IDN) 
      Registration and Administration for Chinese, Japanese, and Korean&quot;, RFC 3743, April 2004.<br>
      http://ietf.org/rfc/rfc3743.txt</span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="RFC3986">RFC3986</a>]</span></td>
      <td class="noborder" valign="top"><span>T. Berners-Lee, R. Fielding, L. Masinter. &quot;Uniform 
      Resource Identifier (URI): Generic Syntax&quot;, RFC 3986, January 2005.<br>
      <a href="http://ietf.org/rfc/rfc3986.txt">http://ietf.org/rfc/rfc3986.txt</a></span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1"><span>[<a name="RFC3987">RFC3987</a>]</span></td>
      <td class="noborder" valign="top"><span>M. Duerst, M. Suignard. &quot;Internationalized Resource 
      Identifiers (IRIs)&quot;, RFC 3987, January 2005.<br>
      <a href="http://ietf.org/rfc/rfc3987.txt">http://ietf.org/rfc/rfc3987.txt</a> </span></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="UCD">UCD</a>]</td>
      <td class="noborder" valign="top">Unicode Character Database.<br>
      <a href="http://www.unicode.org/ucd">http://www.unicode.org/ucd<br>
      </a><i>For an overview of the Unicode Character Database and a list of its associated files</i></td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Unicode">Unicode</a>]</td>
      <td class="noborder" valign="top">The Unicode Consortium.
      <a href="http://www.unicode.org/uni2book/u2.html">The Unicode Standard, Version 4.0</a>. 
      Reading, MA, Addison-Wesley, 2003. 0-321-18578-1.</td>
    </tr>
    <tr>
      <td class="noborder" valign="top" width="1">[<a name="Versions">Versions</a>]</td>
      <td class="noborder" valign="top">Versions of the Unicode Standard<br>
      <a href="http://www.unicode.org/standard/versions">http://www.unicode.org/standard/versions<br>
      </a><i>For information on version numbering, and citing and referencing the Unicode Standard, 
      the Unicode Character Database, and Unicode Technical Reports.</i></td>
    </tr>
  </table>
  <h2><a name="Modifications">Modifications</a></h2>
  <p>The following summarizes modifications from the previous revision of this document.</p>
  <p><span class="changedSpan"><b>Revision 3:</b></span></p>
  <ul>
    <li><span class="changedSpan">Cleaned up references</span></li>
    <li><span class="changedSpan">Added <a href="#Related_Material">Related Material</a> section</span></li>
    <li><span class="changedSpan">Refined recommendations on whole-script confusables</span></li>
  </ul>
  <p><b>Revision 2:</b></p>
  <ul>
    <li><span>Moved recommendations to separate section</span></li>
    <li><span>Added new descriptions, recommendations</span></li>
    <li><span>Pointed to draft data files.</span></li>
  </ul>
  <p><b>Revision 1:</b></p>
  <ul>
    <li>Initial version, following proposal to UTC</li>
    <li>Incorporated comments, restructured, added To Do items</li>
  </ul>
  <hr>
  <p class="copyright">Copyright © 2004-2005 Unicode, Inc. All Rights Reserved. The Unicode 
  Consortium makes no expressed or implied warranty of any kind, and assumes no liability for errors 
  or omissions. No liability is assumed for incidental and consequential damages in connection with 
  or arising out of the use of the information or programs contained or accompanying this technical 
  report. The Unicode <a href="http://www.unicode.org/copyright.html">Terms of Use</a> apply.</p>
  <p class="copyright">Unicode and the Unicode logo are trademarks of Unicode, Inc., and are 
  registered in some jurisdictions.</div>

</body>

</html>
